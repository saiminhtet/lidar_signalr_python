"use strict";import H from"../../parts/Globals.js";import"../../parts/Utilities.js";var Annotation=H.Annotation,MockPoint=Annotation.MockPoint,Tunnel=Annotation.types.tunnel,createPathDGenerator=function(t,n){return function(){var o,i,e=this.annotation,a=this.anchor(e.startRetracements[t]).absolutePosition,s=this.anchor(e.endRetracements[t]).absolutePosition,r=["M",Math.round(a.x),Math.round(a.y),"L",Math.round(s.x),Math.round(s.y)];return n&&(o=this.anchor(e.endRetracements[t-1]).absolutePosition,i=this.anchor(e.startRetracements[t-1]).absolutePosition,r.push("L",Math.round(o.x),Math.round(o.y),"L",Math.round(i.x),Math.round(i.y))),r}};function Fibonacci(){this.startRetracements=[],this.endRetracements=[],Tunnel.apply(this,arguments)}Fibonacci.levels=[0,.236,.382,.5,.618,.786,1],H.extendAnnotation(Fibonacci,Tunnel,{linkPoints:function(){Tunnel.prototype.linkPoints.call(this),this.linkRetracementsPoints()},linkRetracementsPoints:function(){var t=this.points,n=t[0].y-t[3].y,o=t[1].y-t[2].y,i=t[0].x,e=t[1].x;Fibonacci.levels.forEach(function(a,s){var r=t[0].y-n*a,c=t[1].y-o*a;this.linkRetracementPoint(s,i,r,this.startRetracements),this.linkRetracementPoint(s,e,c,this.endRetracements)},this)},linkRetracementPoint:function(t,n,o,i){var e=i[t],a=this.options.typeOptions;e?(e.options.x=n,e.options.y=o,e.refresh()):i[t]=new MockPoint(this.chart,this,{x:n,y:o,xAxis:a.xAxis,yAxis:a.yAxis})},addShapes:function(){Fibonacci.levels.forEach(function(t,n){this.initShape({type:"path",d:createPathDGenerator(n)},!1),n>0&&this.initShape({type:"path",fill:this.options.typeOptions.backgroundColors[n-1],strokeWidth:0,d:createPathDGenerator(n,!0)})},this)},addLabels:function(){Fibonacci.levels.forEach(function(t,n){var o=this.options.typeOptions,i=this.initLabel(H.merge(o.labels[n],{point:function(t){return MockPoint.pointToOptions(t.annotation.startRetracements[n])},text:t.toString()}));o.labels[n]=i.options},this)}},{typeOptions:{height:2,backgroundColors:["rgba(130, 170, 255, 0.4)","rgba(139, 191, 216, 0.4)","rgba(150, 216, 192, 0.4)","rgba(156, 229, 161, 0.4)","rgba(162, 241, 130, 0.4)","rgba(169, 255, 101, 0.4)"],lineColor:"grey",lineColors:[],labels:[]},labelOptions:{allowOverlap:!0,align:"right",backgroundColor:"none",borderWidth:0,crop:!1,overflow:"none",shape:"rect",style:{color:"grey"},verticalAlign:"middle",y:0}}),Annotation.types.fibonacci=Fibonacci;export default Fibonacci;