"use strict";import H from"./../../parts/Globals.js";import"./../../parts/Chart.js";import U from"./../../parts/Utilities.js";var defined=U.defined,objectEach=U.objectEach,splat=U.splat;import"./../../parts/SvgRenderer.js";var defaultMarkers={arrow:{tagName:"marker",render:!1,id:"arrow",refY:5,refX:9,markerWidth:10,markerHeight:10,children:[{tagName:"path",d:"M 0 0 L 10 5 L 0 10 Z",strokeWidth:0}]},"reverse-arrow":{tagName:"marker",render:!1,id:"reverse-arrow",refY:5,refX:1,markerWidth:10,markerHeight:10,children:[{tagName:"path",d:"M 0 5 L 10 0 L 10 10 Z",strokeWidth:0}]}};H.SVGRenderer.prototype.addMarker=function(r,e){var t={id:r},a={stroke:e.color||"none",fill:e.color||"rgba(0, 0, 0, 0.75)"};t.children=e.children.map(function(r){return H.merge(a,r)});var n=this.definition(H.merge(!0,{markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"},e,t));return n.id=r,n};var createMarkerSetter=function(r){return function(e){this.attr(r,"url(#"+e+")")}},markerMixin={markerEndSetter:createMarkerSetter("marker-end"),markerStartSetter:createMarkerSetter("marker-start"),setItemMarkers:function(r){var e=r.options,t=r.chart,a=t.options.defs,n=e.fill,i=defined(n)&&"none"!==n?n:e.stroke;["markerStart","markerEnd"].forEach(function(n){var o,d,s,f,m=e[n];if(m){for(s in a)if(m===(o=a[s]).id&&"marker"===o.tagName){d=o;break}d&&(f=r[n]=t.renderer.addMarker((e.id||H.uniqueKey())+"-"+d.id,H.merge(d,{color:i})),r.attr(n,f.attr("id")))}})}};H.SVGRenderer.prototype.definition=function(r){var e=this;return function r(t,a){var n;return splat(t).forEach(function(t){var i=e.createElement(t.tagName),o={};objectEach(t,function(r,e){"tagName"!==e&&"children"!==e&&"textContent"!==e&&(o[e]=r)}),i.attr(o),i.add(a||e.defs),t.textContent&&i.element.appendChild(H.doc.createTextNode(t.textContent)),r(t.children||[],i),n=i}),n}(r)},H.addEvent(H.Chart,"afterGetContainer",function(){this.options.defs=H.merge(defaultMarkers,this.options.defs||{}),objectEach(this.options.defs,function(r){"marker"===r.tagName&&!1!==r.render&&this.renderer.addMarker(r.id,r)},this)});export default markerMixin;