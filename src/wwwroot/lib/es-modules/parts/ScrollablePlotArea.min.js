"use strict";import H from"./Globals.js";import U from"./Utilities.js";var pick=U.pick,addEvent=H.addEvent,Chart=H.Chart;addEvent(Chart,"afterSetChartSize",function(t){var i,e,s,h=this.options.chart.scrollablePlotArea,l=h&&h.minWidth,r=h&&h.minHeight;this.renderer.forExport||(l?(this.scrollablePixelsX=i=Math.max(0,l-this.chartWidth),i&&(this.plotWidth+=i,this.inverted?(this.clipBox.height+=i,this.plotBox.height+=i):(this.clipBox.width+=i,this.plotBox.width+=i),s={1:{name:"right",value:i}})):r&&(this.scrollablePixelsY=e=Math.max(0,r-this.chartHeight),e&&(this.plotHeight+=e,this.inverted?(this.clipBox.width+=e,this.plotBox.width+=e):(this.clipBox.height+=e,this.plotBox.height+=e),s={2:{name:"bottom",value:e}})),s&&!t.skipAxes&&this.axes.forEach(function(t){s[t.side]?t.getPlotLinePath=function(){var i,e=s[t.side].name,h=s[t.side].value,l=this[e];return this[e]=l-h,i=H.Axis.prototype.getPlotLinePath.apply(this,arguments),this[e]=l,i}:(t.setAxisSize(),t.setAxisTranslation())}))}),addEvent(Chart,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),Chart.prototype.setUpScrolling=function(){var t={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(t.overflowX="auto"),this.scrollablePixelsY&&(t.overflowY="auto"),this.scrollingContainer=H.createElement("div",{className:"highcharts-scrolling"},t,this.renderTo),this.innerContainer=H.createElement("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},Chart.prototype.moveFixedElements=function(){var t,i=this.container,e=this.fixedRenderer,s=[".highcharts-contextbutton",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];this.scrollablePixelsX&&!this.inverted?t=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&!this.inverted?t=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(t=".highcharts-yaxis"),s.push(t,t+"-labels"),s.forEach(function(t){[].forEach.call(i.querySelectorAll(t),function(t){(t.namespaceURI===e.SVG_NS?e.box:e.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})})},Chart.prototype.applyFixed=function(){var t,i,e,s=!this.fixedDiv,h=this.options.chart.scrollablePlotArea;s?(this.fixedDiv=H.createElement("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:2},null,!0),this.renderTo.insertBefore(this.fixedDiv,this.renderTo.firstChild),this.renderTo.style.overflow="visible",this.fixedRenderer=t=new H.Renderer(this.fixedDiv,this.chartWidth,this.chartHeight),this.scrollableMask=t.path().attr({fill:H.color(this.options.chart.backgroundColor||"#fff").setOpacity(pick(h.opacity,.85)).get(),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),this.moveFixedElements(),addEvent(this,"afterShowResetZoom",this.moveFixedElements),addEvent(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),i=this.chartWidth+(this.scrollablePixelsX||0),e=this.chartHeight+(this.scrollablePixelsY||0),H.stop(this.container),this.container.style.width=i+"px",this.container.style.height=e+"px",this.renderer.boxWrapper.attr({width:i,height:e,viewBox:[0,0,i,e].join(" ")}),this.chartBackground.attr({width:i,height:e}),this.scrollablePixelsY&&(this.scrollingContainer.style.height=this.chartHeight+"px"),s&&(h.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*h.scrollPositionX),h.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*h.scrollPositionY));var l,r=this.axisOffset,o=this.plotTop-r[0]-1,a=this.plotLeft-r[3]-1,n=this.plotTop+this.plotHeight+r[2]+1,c=this.plotLeft+this.plotWidth+r[1]+1,d=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),p=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0);l=this.scrollablePixelsX?["M",0,o,"L",this.plotLeft-1,o,"L",this.plotLeft-1,n,"L",0,n,"Z","M",d,o,"L",this.chartWidth,o,"L",this.chartWidth,n,"L",d,n,"Z"]:this.scrollablePixelsY?["M",a,0,"L",a,this.plotTop-1,"L",c,this.plotTop-1,"L",c,0,"Z","M",a,p,"L",a,this.chartHeight,"L",c,this.chartHeight,"L",c,p,"Z"]:["M",0,0],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:l})};