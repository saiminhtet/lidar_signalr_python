"use strict";import H from"./Globals.js";import U from"./Utilities.js";var attr=U.attr,defined=U.defined,destroyObjectProperties=U.destroyObjectProperties,erase=U.erase,extend=U.extend,isArray=U.isArray,isNumber=U.isNumber,isObject=U.isObject,isString=U.isString,objectEach=U.objectEach,pick=U.pick,pInt=U.pInt,splat=U.splat;import"./Color.js";var SVGElement,SVGRenderer,addEvent=H.addEvent,animate=H.animate,charts=H.charts,color=H.color,css=H.css,createElement=H.createElement,deg2rad=H.deg2rad,doc=H.doc,hasTouch=H.hasTouch,isFirefox=H.isFirefox,isMS=H.isMS,isWebKit=H.isWebKit,merge=H.merge,noop=H.noop,removeEvent=H.removeEvent,stop=H.stop,svg=H.svg,SVG_NS=H.SVG_NS,symbolSizes=H.symbolSizes,win=H.win;SVGElement=H.SVGElement=function(){return this},extend(SVGElement.prototype,{opacity:1,SVG_NS:SVG_NS,textProps:["direction","fontSize","fontWeight","fontFamily","fontStyle","color","lineHeight","width","textAlign","textDecoration","textOverflow","textOutline","cursor"],init:function(t,e){this.element="span"===e?createElement(e):doc.createElementNS(this.SVG_NS,e),this.renderer=t,H.fireEvent(this,"afterInit")},animate:function(t,e,i){var r=H.animObject(pick(e,this.renderer.globalAnimation,!0));return pick(doc.hidden,doc.msHidden,doc.webkitHidden,!1)&&(r.duration=0),0!==r.duration?(i&&(r.complete=i),animate(this,t,r)):(this.attr(t,void 0,i),objectEach(t,function(t,e){r.step&&r.step.call(this,t,{prop:e,pos:1})},this)),this},complexColor:function(t,e,i){var r,n,s,o,a,h,l,d,c,u,f,p,g=this.renderer,m=[];H.fireEvent(this.renderer,"complexColor",{args:arguments},function(){t.radialGradient?n="radialGradient":t.linearGradient&&(n="linearGradient"),n&&(s=t[n],a=g.gradients,l=t.stops,u=i.radialReference,isArray(s)&&(t[n]=s={x1:s[0],y1:s[1],x2:s[2],y2:s[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===n&&u&&!defined(s.gradientUnits)&&(o=s,s=merge(s,g.getRadialAttr(u,o),{gradientUnits:"userSpaceOnUse"})),objectEach(s,function(t,e){"id"!==e&&m.push(e,t)}),objectEach(l,function(t){m.push(t)}),m=m.join(","),a[m]?f=a[m].attr("id"):(s.id=f=H.uniqueKey(),a[m]=h=g.createElement(n).attr(s).add(g.defs),h.radAttr=o,h.stops=[],l.forEach(function(t){var e;0===t[1].indexOf("rgba")?(r=H.color(t[1]),d=r.get("rgb"),c=r.get("a")):(d=t[1],c=1),e=g.createElement("stop").attr({offset:t[0],"stop-color":d,"stop-opacity":c}).add(h),h.stops.push(e)})),p="url("+g.url+"#"+f+")",i.setAttribute(e,p),i.gradient=m,t.toString=function(){return p})})},applyTextOutline:function(t){var e,i,r,n,s=this.element;-1!==t.indexOf("contrast")&&(t=t.replace(/contrast/g,this.renderer.getContrast(s.style.fill))),t=t.split(" "),i=t[t.length-1],(r=t[0])&&"none"!==r&&H.svg&&(this.fakeTS=!0,e=[].slice.call(s.getElementsByTagName("tspan")),this.ySetter=this.xSetter,r=r.replace(/(^[\d\.]+)(.*?)$/g,function(t,e,i){return 2*e+i}),this.removeTextOutline(e),n=s.firstChild,e.forEach(function(t,e){var o;0===e&&(t.setAttribute("x",s.getAttribute("x")),e=s.getAttribute("y"),t.setAttribute("y",e||0),null===e&&s.setAttribute("y",0)),o=t.cloneNode(1),attr(o,{class:"highcharts-text-outline",fill:i,stroke:i,"stroke-width":r,"stroke-linejoin":"round"}),s.insertBefore(o,n)}))},removeTextOutline:function(t){for(var e,i=t.length;i--;)"highcharts-text-outline"===(e=t[i]).getAttribute("class")&&erase(t,this.element.removeChild(e))},symbolCustomAttribs:["x","y","width","height","r","start","end","innerR","anchorX","anchorY","rounded"],attr:function(t,e,i,r){var n,s,o,a,h=this.element,l=this,d=this.symbolCustomAttribs;return"string"==typeof t&&void 0!==e&&(n=t,(t={})[n]=e),"string"==typeof t?l=(this[t+"Getter"]||this._defaultGetter).call(this,t,h):(objectEach(t,function(e,i){o=!1,r||stop(this,i),this.symbolName&&-1!==H.inArray(i,d)&&(s||(this.symbolAttr(t),s=!0),o=!0),!this.rotation||"x"!==i&&"y"!==i||(this.doTransform=!0),o||((a=this[i+"Setter"]||this._defaultSetter).call(this,e,i,h),!this.styledMode&&this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(i)&&this.updateShadows(i,e,a))},this),this.afterSetters()),i&&i.call(this),l},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(t,e,i){for(var r=this.shadows,n=r.length;n--;)i.call(r[n],"height"===t?Math.max(e-(r[n].cutHeight||0),0):"d"===t?this.d:e,t,r[n])},addClass:function(t,e){var i=e?"":this.attr("class")||"";return(t=(t||"").split(/ /g).reduce(function(t,e){return-1===i.indexOf(e)&&t.push(e),t},i?[i]:[]).join(" "))!==i&&this.attr("class",t),this},hasClass:function(t){return-1!==(this.attr("class")||"").split(" ").indexOf(t)},removeClass:function(t){return this.attr("class",(this.attr("class")||"").replace(isString(t)?new RegExp(" ?"+t+" ?"):t,""))},symbolAttr:function(t){var e=this;["x","y","r","start","end","width","height","innerR","anchorX","anchorY","clockwise"].forEach(function(i){e[i]=pick(t[i],e[i])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},clip:function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":"none")},crisp:function(t,e){var i;return e=e||t.strokeWidth||0,i=Math.round(e)%2/2,t.x=Math.floor(t.x||this.x||0)+i,t.y=Math.floor(t.y||this.y||0)+i,t.width=Math.floor((t.width||this.width||0)-2*i),t.height=Math.floor((t.height||this.height||0)-2*i),defined(t.strokeWidth)&&(t.strokeWidth=e),t},css:function(t){var e,i,r=this.styles,n={},s=this.element,o="",a=!r,h=["textOutline","textOverflow","width"];return t&&t.color&&(t.fill=t.color),r&&objectEach(t,function(t,e){t!==r[e]&&(n[e]=t,a=!0)}),a&&(r&&(t=extend(r,n)),t&&(null===t.width||"auto"===t.width?delete this.textWidth:"text"===s.nodeName.toLowerCase()&&t.width&&(e=this.textWidth=pInt(t.width))),this.styles=t,e&&!svg&&this.renderer.forExport&&delete t.width,s.namespaceURI===this.SVG_NS?(i=function(t,e){return"-"+e.toLowerCase()},objectEach(t,function(t,e){-1===h.indexOf(e)&&(o+=e.replace(/([A-Z])/g,i)+":"+t+";")}),o&&attr(s,"style",o)):css(s,t),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),t&&t.textOutline&&this.applyTextOutline(t.textOutline))),this},getStyle:function(t){return win.getComputedStyle(this.element||this,"").getPropertyValue(t)},strokeWidth:function(){if(!this.renderer.styledMode)return this["stroke-width"]||0;var t,e,i=this.getStyle("stroke-width");return i.indexOf("px")===i.length-2?t=pInt(i):(e=doc.createElementNS(SVG_NS,"rect"),attr(e,{width:i,"stroke-width":0}),this.element.parentNode.appendChild(e),t=e.getBBox().width,e.parentNode.removeChild(e)),t},on:function(t,e){var i=this,r=i.element;return hasTouch&&"click"===t?(r.ontouchstart=function(t){i.touchEventFired=Date.now(),t.preventDefault(),e.call(r,t)},r.onclick=function(t){(-1===win.navigator.userAgent.indexOf("Android")||Date.now()-(i.touchEventFired||0)>1100)&&e.call(r,t)}):r["on"+t]=e,this},setRadialReference:function(t){var e=this.renderer.gradients[this.element.gradient];return this.element.radialReference=t,e&&e.radAttr&&e.animate(this.renderer.getRadialAttr(t,e.radAttr)),this},translate:function(t,e){return this.attr({translateX:t,translateY:e})},invert:function(t){return this.inverted=t,this.updateTransform(),this},updateTransform:function(){var t,e=this.translateX||0,i=this.translateY||0,r=this.scaleX,n=this.scaleY,s=this.inverted,o=this.rotation,a=this.matrix,h=this.element;s&&(e+=this.width,i+=this.height),t=["translate("+e+","+i+")"],defined(a)&&t.push("matrix("+a.join(",")+")"),s?t.push("rotate(90) scale(-1,1)"):o&&t.push("rotate("+o+" "+pick(this.rotationOriginX,h.getAttribute("x"),0)+" "+pick(this.rotationOriginY,h.getAttribute("y")||0)+")"),(defined(r)||defined(n))&&t.push("scale("+pick(r,1)+" "+pick(n,1)+")"),t.length&&h.setAttribute("transform",t.join(" "))},toFront:function(){var t=this.element;return t.parentNode.appendChild(t),this},align:function(t,e,i){var r,n,s,o,a,h,l,d={},c=this.renderer,u=c.alignedObjects;return t?(this.alignOptions=t,this.alignByTranslate=e,i&&!isString(i)||(this.alignTo=a=i||"renderer",erase(u,this),u.push(this),i=null)):(t=this.alignOptions,e=this.alignByTranslate,a=this.alignTo),i=pick(i,c[a],c),r=t.align,n=t.verticalAlign,s=(i.x||0)+(t.x||0),o=(i.y||0)+(t.y||0),"right"===r?h=1:"center"===r&&(h=2),h&&(s+=(i.width-(t.width||0))/h),d[e?"translateX":"x"]=Math.round(s),"bottom"===n?l=1:"middle"===n&&(l=2),l&&(o+=(i.height-(t.height||0))/l),d[e?"translateY":"y"]=Math.round(o),this[this.placed?"animate":"attr"](d),this.placed=!0,this.alignAttr=d,this},getBBox:function(t,e){var i,r,n,s,o,a,h=this.renderer,l=this.element,d=this.styles,c=this.textStr,u=h.cache,f=h.cacheKeys,p=l.namespaceURI===this.SVG_NS,g=pick(e,this.rotation,0);if(s=h.styledMode?l&&SVGElement.prototype.getStyle.call(l,"font-size"):d&&d.fontSize,defined(c)&&(-1===(a=c.toString()).indexOf("<")&&(a=a.replace(/[0-9]/g,"0")),a+=["",g,s,this.textWidth,d&&d.textOverflow].join(",")),a&&!t&&(i=u[a]),!i){if(p||h.forExport){try{(o=this.fakeTS&&function(t){[].forEach.call(l.querySelectorAll(".highcharts-text-outline"),function(e){e.style.display=t})})&&o("none"),i=l.getBBox?extend({},l.getBBox()):{width:l.offsetWidth,height:l.offsetHeight},o&&o("")}catch(t){}(!i||i.width<0)&&(i={width:0,height:0})}else i=this.htmlGetBBox();if(h.isSVG&&(r=i.width,n=i.height,p&&(i.height=n={"11px,17":14,"13px,20":16}[d&&d.fontSize+","+Math.round(n)]||n),g)){var m=g*deg2rad;i.width=Math.abs(n*Math.sin(m))+Math.abs(r*Math.cos(m)),i.height=Math.abs(n*Math.cos(m))+Math.abs(r*Math.sin(m))}if(a&&i.height>0){for(;f.length>250;)delete u[f.shift()];u[a]||f.push(a),u[a]=i}}return i},show:function(t){return this.attr({visibility:t?"inherit":"visible"})},hide:function(t){return t?this.attr({y:-9999}):this.attr({visibility:"hidden"}),this},fadeOut:function(t){var e=this;e.animate({opacity:0},{duration:t||150,complete:function(){e.attr({y:-9999})}})},add:function(t){var e,i=this.renderer,r=this.element;return t&&(this.parentGroup=t),this.parentInverted=t&&t.inverted,void 0!==this.textStr&&i.buildText(this),this.added=!0,(!t||t.handleZ||this.zIndex)&&(e=this.zIndexSetter()),e||(t?t.element:i.box).appendChild(r),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(t){var e=t.parentNode;e&&e.removeChild(t)},destroy:function(){var t,e,i=this,r=i.element||{},n=i.renderer,s=n.isSVG&&"SPAN"===r.nodeName&&i.parentGroup,o=r.ownerSVGElement,a=i.clipPath;if(r.onclick=r.onmouseout=r.onmouseover=r.onmousemove=r.point=null,stop(i),a&&o&&([].forEach.call(o.querySelectorAll("[clip-path],[CLIP-PATH]"),function(t){t.getAttribute("clip-path").indexOf(a.element.id)>-1&&t.removeAttribute("clip-path")}),i.clipPath=a.destroy()),i.stops){for(e=0;e<i.stops.length;e++)i.stops[e]=i.stops[e].destroy();i.stops=null}for(i.safeRemoveChild(r),n.styledMode||i.destroyShadows();s&&s.div&&0===s.div.childNodes.length;)t=s.parentGroup,i.safeRemoveChild(s.div),delete s.div,s=t;i.alignTo&&erase(n.alignedObjects,i),objectEach(i,function(t,e){i[e]&&i[e].parentGroup===i&&i[e].destroy&&i[e].destroy(),delete i[e]})},shadow:function(t,e,i){var r,n,s,o,a,h,l=[],d=this.element;if(t){if(!this.shadows){for(o=pick(t.width,3),a=(t.opacity||.15)/o,h=this.parentInverted?"(-1,-1)":"("+pick(t.offsetX,1)+", "+pick(t.offsetY,1)+")",r=1;r<=o;r++)n=d.cloneNode(0),s=2*o+1-2*r,attr(n,{stroke:t.color||"#000000","stroke-opacity":a*r,"stroke-width":s,transform:"translate"+h,fill:"none"}),n.setAttribute("class",(n.getAttribute("class")||"")+" highcharts-shadow"),i&&(attr(n,"height",Math.max(attr(n,"height")-s,0)),n.cutHeight=s),e?e.element.appendChild(n):d.parentNode&&d.parentNode.insertBefore(n,d),l.push(n);this.shadows=l}}else this.destroyShadows();return this},destroyShadows:function(){(this.shadows||[]).forEach(function(t){this.safeRemoveChild(t)},this),this.shadows=void 0},xGetter:function(t){return"circle"===this.element.nodeName&&("x"===t?t="cx":"y"===t&&(t="cy")),this._defaultGetter(t)},_defaultGetter:function(t){var e=pick(this[t+"Value"],this[t],this.element?this.element.getAttribute(t):null,0);return/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e},dSetter:function(t,e,i){t&&t.join&&(t=t.join(" ")),/(NaN| {2}|^$)/.test(t)&&(t="M 0 0"),this[e]!==t&&(i.setAttribute(e,t),this[e]=t)},dashstyleSetter:function(t){var e,i=this["stroke-width"];if("inherit"===i&&(i=1),t=t&&t.toLowerCase()){for(e=(t=t.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",")).length;e--;)t[e]=pInt(t[e])*i;t=t.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",t)}},alignSetter:function(t){var e={left:"start",center:"middle",right:"end"};e[t]&&(this.alignValue=t,this.element.setAttribute("text-anchor",e[t]))},opacitySetter:function(t,e,i){this[e]=t,i.setAttribute(e,t)},titleSetter:function(t){var e=this.element.getElementsByTagName("title")[0];e||(e=doc.createElementNS(this.SVG_NS,"title"),this.element.appendChild(e)),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(doc.createTextNode(String(pick(t,"")).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")))},textSetter:function(t){t!==this.textStr&&(delete this.bBox,delete this.textPxLength,this.textStr=t,this.added&&this.renderer.buildText(this))},setTextPath:function(t,e){var i,r,n,s,o=this.element,a={textAnchor:"text-anchor"},h=!1,l=this.textPathWrapper,d=!l;if(i=(e=merge(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},e)).attributes,t&&e&&e.enabled){if(this.options&&this.options.padding&&(i.dx=-this.options.padding),l||(this.textPathWrapper=l=this.renderer.createElement("textPath"),h=!0),r=l.element,(n=t.element.getAttribute("id"))||t.element.setAttribute("id",n=H.uniqueKey()),d)for(s=o.getElementsByTagName("tspan");s.length;)s[0].setAttribute("y",0),r.appendChild(s[0]);h&&l.add({element:this.text?this.text.element:o}),r.setAttributeNS("http://www.w3.org/1999/xlink","href",this.renderer.url+"#"+n),defined(i.dy)&&(r.parentNode.setAttribute("dy",i.dy),delete i.dy),defined(i.dx)&&(r.parentNode.setAttribute("dx",i.dx),delete i.dx),objectEach(i,function(t,e){r.setAttribute(a[e]||e,t)}),o.removeAttribute("transform"),this.removeTextOutline.call(l,[].slice.call(o.getElementsByTagName("tspan"))),this.text&&!this.renderer.styledMode&&this.attr({fill:"none","stroke-width":0}),this.updateTransform=noop,this.applyTextOutline=noop}else l&&(delete this.updateTransform,delete this.applyTextOutline,this.destroyTextPath(o,t));return this},destroyTextPath:function(t,e){var i;for(e.element.setAttribute("id",""),i=this.textPathWrapper.element.childNodes;i.length;)t.firstChild.appendChild(i[0]);t.firstChild.removeChild(this.textPathWrapper.element),delete e.textPathWrapper},fillSetter:function(t,e,i){"string"==typeof t?i.setAttribute(e,t):t&&this.complexColor(t,e,i)},visibilitySetter:function(t,e,i){"inherit"===t?i.removeAttribute(e):this[e]!==t&&i.setAttribute(e,t),this[e]=t},zIndexSetter:function(t,e){var i,r,n,s,o,a=this.renderer,h=this.parentGroup,l=(h||a).element||a.box,d=this.element,c=!1,u=l===a.box,f=this.added;if(defined(t)?(d.setAttribute("data-z-index",t),t=+t,this[e]===t&&(f=!1)):defined(this[e])&&d.removeAttribute("data-z-index"),this[e]=t,f){for((t=this.zIndex)&&h&&(h.handleZ=!0),o=(i=l.childNodes).length-1;o>=0&&!c;o--)n=(r=i[o]).getAttribute("data-z-index"),s=!defined(n),r!==d&&(t<0&&s&&!u&&!o?(l.insertBefore(d,i[o]),c=!0):(pInt(n)<=t||s&&(!defined(t)||t>=0))&&(l.insertBefore(d,i[o+1]||null),c=!0));c||(l.insertBefore(d,i[u?3:0]||null),c=!0)}return c},_defaultSetter:function(t,e,i){i.setAttribute(e,t)}}),SVGElement.prototype.yGetter=SVGElement.prototype.xGetter,SVGElement.prototype.translateXSetter=SVGElement.prototype.translateYSetter=SVGElement.prototype.rotationSetter=SVGElement.prototype.verticalAlignSetter=SVGElement.prototype.rotationOriginXSetter=SVGElement.prototype.rotationOriginYSetter=SVGElement.prototype.scaleXSetter=SVGElement.prototype.scaleYSetter=SVGElement.prototype.matrixSetter=function(t,e){this[e]=t,this.doTransform=!0},SVGElement.prototype["stroke-widthSetter"]=SVGElement.prototype.strokeSetter=function(t,e,i){this[e]=t,this.stroke&&this["stroke-width"]?(SVGElement.prototype.fillSetter.call(this,this.stroke,"stroke",i),i.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===e&&0===t&&this.hasStroke?(i.removeAttribute("stroke"),this.hasStroke=!1):this.renderer.styledMode&&this["stroke-width"]&&(i.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0)},SVGRenderer=H.SVGRenderer=function(){this.init.apply(this,arguments)},extend(SVGRenderer.prototype,{Element:SVGElement,SVG_NS:SVG_NS,init:function(t,e,i,r,n,s,o){var a,h,l,d;a=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),o||a.css(this.getStyle(r)),h=a.element,t.appendChild(h),attr(t,"dir","ltr"),-1===t.innerHTML.indexOf("xmlns")&&attr(h,"xmlns",this.SVG_NS),this.isSVG=!0,this.box=h,this.boxWrapper=a,this.alignedObjects=[],this.url=(isFirefox||isWebKit)&&doc.getElementsByTagName("base").length?win.location.href.split("#")[0].replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.createElement("desc").add().element.appendChild(doc.createTextNode("Created with Highcharts 7.2.2")),this.defs=this.createElement("defs").add(),this.allowHTML=s,this.forExport=n,this.styledMode=o,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(e,i,!1),isFirefox&&t.getBoundingClientRect&&((l=function(){css(t,{left:0,top:0}),d=t.getBoundingClientRect(),css(t,{left:Math.ceil(d.left)-d.left+"px",top:Math.ceil(d.top)-d.top+"px"})})(),this.unSubPixelFix=addEvent(win,"resize",l))},definition:function(t){var e=this;return function t(i,r){var n;return splat(i).forEach(function(i){var s=e.createElement(i.tagName),o={};objectEach(i,function(t,e){"tagName"!==e&&"children"!==e&&"textContent"!==e&&(o[e]=t)}),s.attr(o),s.add(r||e.defs),i.textContent&&s.element.appendChild(doc.createTextNode(i.textContent)),t(i.children||[],s),n=s}),n}(t)},getStyle:function(t){return this.style=extend({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},t),this.style},setStyle:function(t){this.boxWrapper.css(this.getStyle(t))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),destroyObjectProperties(this.gradients||{}),this.gradients=null,t&&(this.defs=t.destroy()),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null},createElement:function(t){var e=new this.Element;return e.init(this,t),e},draw:noop,getRadialAttr:function(t,e){return{cx:t[0]-t[2]/2+e.cx*t[2],cy:t[1]-t[2]/2+e.cy*t[2],r:e.r*t[2]}},truncate:function(t,e,i,r,n,s,o){var a,h,l,d=this,c=t.rotation,u=r?1:0,f=(i||r).length,p=f,g=[],m=function(t){e.firstChild&&e.removeChild(e.firstChild),t&&e.appendChild(doc.createTextNode(t))},x=function(s,a){var h=a||s;if(void 0===g[h])if(e.getSubStringLength)try{g[h]=n+e.getSubStringLength(0,r?h+1:h)}catch(t){}else d.getSpanWidth&&(m(o(i||r,s)),g[h]=n+d.getSpanWidth(t,e));return g[h]};if(t.rotation=0,h=x(e.textContent.length),l=n+h>s){for(;u<=f;)p=Math.ceil((u+f)/2),r&&(a=o(r,p)),h=x(p,a&&a.length-1),u===f?u=f+1:h>s?f=p-1:u=p;0===f?m(""):i&&f===i.length-1||m(a||o(i||r,p))}return r&&r.splice(0,p),t.actualWidth=h,t.rotation=c,l},escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},buildText:function(t){var e,i,r,n=t.element,s=this,o=s.forExport,a=pick(t.textStr,"").toString(),h=-1!==a.indexOf("<"),l=n.childNodes,d=attr(n,"x"),c=t.styles,u=t.textWidth,f=c&&c.lineHeight,p=c&&c.textOutline,g=c&&"ellipsis"===c.textOverflow,m=c&&"nowrap"===c.whiteSpace,x=c&&c.fontSize,y=l.length,S=u&&!t.added&&this.box,b=function(t){var e;return s.styledMode||(e=/(px|em)$/.test(t&&t.style.fontSize)?t.style.fontSize:x||s.style.fontSize||12),f?pInt(f):s.fontMetrics(e,t.getAttribute("style")?t:n).h},v=function(t,e){return objectEach(s.escapes,function(i,r){e&&-1!==e.indexOf(i)||(t=t.toString().replace(new RegExp(i,"g"),r))}),t},w=function(t,e){var i,r;if(i=t.indexOf("<"),-1!==(i=(t=t.substring(i,t.indexOf(">")-i)).indexOf(e+"="))&&(i=i+e.length+1,'"'===(r=t.charAt(i))||"'"===r))return(t=t.substring(i+1)).substring(0,t.indexOf(r))},A=/<br.*?>/g;if((i=[a,g,m,f,p,x,u].join(","))!==t.textCache){for(t.textCache=i;y--;)n.removeChild(l[y]);h||p||g||u||-1!==a.indexOf(" ")&&(!m||A.test(a))?(S&&S.appendChild(n),(h?(s.styledMode?a.replace(/<(b|strong)>/g,'<span class="highcharts-strong">').replace(/<(i|em)>/g,'<span class="highcharts-emphasized">'):a.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">')).replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(A):[a]).filter(function(t){return""!==t}).forEach(function(i,a){var h,l=0,c=0;i=i.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),(h=i.split("|||")).forEach(function(i){if(""!==i||1===h.length){var f,p,y,S,A={},E=doc.createElementNS(s.SVG_NS,"tspan");if((p=w(i,"class"))&&attr(E,"class",p),(y=w(i,"style"))&&(y=y.replace(/(;| |^)color([ :])/,"$1fill$2"),attr(E,"style",y)),(S=w(i,"href"))&&!o&&-1===S.split(":")[0].toLowerCase().indexOf("javascript")&&(f=doc.createElementNS(s.SVG_NS,"a"),attr(f,"href",S),attr(E,"class","highcharts-anchor"),f.appendChild(E),s.styledMode||css(E,{cursor:"pointer"}))," "!==(i=v(i.replace(/<[a-zA-Z\/](.|\n)*?>/g,"")||" "))){if(E.appendChild(doc.createTextNode(i)),l?A.dx=0:a&&null!==d&&(A.x=d),attr(E,A),n.appendChild(f||E),!l&&r&&(!svg&&o&&css(E,{display:"block"}),attr(E,"dy",b(E))),u){var M=i.replace(/([^\^])-/g,"$1- ").split(" "),C=!m&&(h.length>1||a||M.length>1),k=0,N=b(E);if(g)e=s.truncate(t,E,i,void 0,0,Math.max(0,u-parseInt(x||12,10)),function(t,e){return t.substring(0,e)+"…"});else if(C)for(;M.length;)M.length&&!m&&k>0&&(E=doc.createElementNS(SVG_NS,"tspan"),attr(E,{dy:N,x:d}),y&&attr(E,"style",y),E.appendChild(doc.createTextNode(M.join(" ").replace(/- /g,"-"))),n.appendChild(E)),s.truncate(t,E,null,M,0===k?c:0,u,function(t,e){return M.slice(0,e).join(" ").replace(/- /g,"-")}),c=t.actualWidth,k++}l++}}}),r=r||n.childNodes.length}),g&&e&&t.attr("title",v(t.textStr,["&lt;","&gt;"])),S&&S.removeChild(n),p&&t.applyTextOutline&&t.applyTextOutline(p)):n.appendChild(doc.createTextNode(v(a)))}},getContrast:function(t){return(t=color(t).rgba)[0]*=1,t[1]*=1.2,t[2]*=.5,t[0]+t[1]+t[2]>459?"#000000":"#FFFFFF"},button:function(t,e,i,r,n,s,o,a,h,l){var d,c,u,f,p=this.label(t,e,i,h,null,null,l,null,"button"),g=0,m=this.styledMode;(p.attr(merge({padding:8,r:2},n)),m)||(n=merge({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},n),d=n.style,delete n.style,s=merge(n,{fill:"#e6e6e6"},s),c=s.style,delete s.style,o=merge(n,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},o),u=o.style,delete o.style,a=merge(n,{style:{color:"#cccccc"}},a),f=a.style,delete a.style);return addEvent(p.element,isMS?"mouseover":"mouseenter",function(){3!==g&&p.setState(1)}),addEvent(p.element,isMS?"mouseout":"mouseleave",function(){3!==g&&p.setState(g)}),p.setState=function(t){1!==t&&(p.state=g=t),p.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),m||p.attr([n,s,o,a][t||0]).css([d,c,u,f][t||0])},m||p.attr(n).css(extend({cursor:"default"},d)),p.on("click",function(t){3!==g&&r.call(p,t)})},crispLine:function(t,e){return t[1]===t[4]&&(t[1]=t[4]=Math.round(t[1])-e%2/2),t[2]===t[5]&&(t[2]=t[5]=Math.round(t[2])+e%2/2),t},path:function(t){var e=this.styledMode?{}:{fill:"none"};return isArray(t)?e.d=t:isObject(t)&&extend(e,t),this.createElement("path").attr(e)},circle:function(t,e,i){var r=isObject(t)?t:void 0===t?{}:{x:t,y:e,r:i},n=this.createElement("circle");return n.xSetter=n.ySetter=function(t,e,i){i.setAttribute("c"+e,t)},n.attr(r)},arc:function(t,e,i,r,n,s){var o,a;return isObject(t)?(e=(a=t).y,i=a.r,r=a.innerR,n=a.start,s=a.end,t=a.x):a={innerR:r,start:n,end:s},(o=this.symbol("arc",t,e,i,i,a)).r=i,o},rect:function(t,e,i,r,n,s){n=isObject(t)?t.r:n;var o=this.createElement("rect"),a=isObject(t)?t:void 0===t?{}:{x:t,y:e,width:Math.max(i,0),height:Math.max(r,0)};return this.styledMode||(void 0!==s&&(a.strokeWidth=s,a=o.crisp(a)),a.fill="none"),n&&(a.r=n),o.rSetter=function(t,e,i){o.r=t,attr(i,{rx:t,ry:t})},o.rGetter=function(){return o.r},o.attr(a)},setSize:function(t,e,i){var r=this.alignedObjects,n=r.length;for(this.width=t,this.height=e,this.boxWrapper.animate({width:t,height:e},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:pick(i,!0)?void 0:0});n--;)r[n].align()},g:function(t){var e=this.createElement("g");return t?e.attr({class:"highcharts-"+t}):e},image:function(t,e,i,r,n,s){var o,a,h={preserveAspectRatio:"none"},l=function(t,e){t.setAttributeNS?t.setAttributeNS("http://www.w3.org/1999/xlink","href",e):t.setAttribute("hc-svg-href",e)},d=function(e){l(o.element,t),s.call(o,e)};return arguments.length>1&&extend(h,{x:e,y:i,width:r,height:n}),o=this.createElement("image").attr(h),s?(l(o.element,"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),a=new win.Image,addEvent(a,"load",d),a.src=t,a.complete&&d({})):l(o.element,t),o},symbol:function(t,e,i,r,n,s){var o,a,h,l=this,d=/^url\((.*?)\)$/,c=d.test(t),u=!c&&(this.symbols[t]?t:"circle"),f=u&&this.symbols[u],p=defined(e)&&f&&f.call(this.symbols,Math.round(e),Math.round(i),r,n,s);return f?(o=this.path(p),l.styledMode||o.attr("fill","none"),extend(o,{symbolName:u,x:e,y:i,width:r,height:n}),s&&extend(o,s)):c&&(a=t.match(d)[1],(o=this.image(a)).imgwidth=pick(symbolSizes[a]&&symbolSizes[a].width,s&&s.width),o.imgheight=pick(symbolSizes[a]&&symbolSizes[a].height,s&&s.height),h=function(){o.attr({width:o.width,height:o.height})},["width","height"].forEach(function(t){o[t+"Setter"]=function(t,e){var i={},r=this["img"+e],n="width"===e?"translateX":"translateY";this[e]=t,defined(r)&&(s&&"within"===s.backgroundSize&&this.width&&this.height&&(r=Math.round(r*Math.min(this.width/this.imgwidth,this.height/this.imgheight))),this.element&&this.element.setAttribute(e,r),this.alignByTranslate||(i[n]=((this[e]||0)-r)/2,this.attr(i)))}}),defined(e)&&o.attr({x:e,y:i}),o.isImg=!0,defined(o.imgwidth)&&defined(o.imgheight)?h():(o.attr({width:0,height:0}),createElement("img",{onload:function(){var t=charts[l.chartIndex];0===this.width&&(css(this,{position:"absolute",top:"-999em"}),doc.body.appendChild(this)),symbolSizes[a]={width:this.width,height:this.height},o.imgwidth=this.width,o.imgheight=this.height,o.element&&h(),this.parentNode&&this.parentNode.removeChild(this),l.imgCount--,!l.imgCount&&t&&t.onload&&t.onload()},src:a}),this.imgCount++)),o},symbols:{circle:function(t,e,i,r){return this.arc(t+i/2,e+r/2,i/2,r/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},square:function(t,e,i,r){return["M",t,e,"L",t+i,e,t+i,e+r,t,e+r,"Z"]},triangle:function(t,e,i,r){return["M",t+i/2,e,"L",t+i,e+r,t,e+r,"Z"]},"triangle-down":function(t,e,i,r){return["M",t,e,"L",t+i,e,t+i/2,e+r,"Z"]},diamond:function(t,e,i,r){return["M",t+i/2,e,"L",t+i,e+r/2,t+i/2,e+r,t,e+r/2,"Z"]},arc:function(t,e,i,r,n){var s,o=n.start,a=n.r||i,h=n.r||r||i,l=Math.abs(n.end-n.start-2*Math.PI)<.001,d=n.end-.001,c=n.innerR,u=pick(n.open,l),f=Math.cos(o),p=Math.sin(o),g=Math.cos(d),m=Math.sin(d),x=n.end-o-Math.PI<.001?0:1;return s=["M",t+a*f,e+h*p,"A",a,h,0,x,pick(n.clockwise,1),t+a*g,e+h*m],defined(c)&&s.push(u?"M":"L",t+c*g,e+c*m,"A",c,c,0,x,0,t+c*f,e+c*p),s.push(u?"":"Z"),s},callout:function(t,e,i,r,n){var s,o=Math.min(n&&n.r||0,i,r),a=o+6,h=n&&n.anchorX,l=n&&n.anchorY;return s=["M",t+o,e,"L",t+i-o,e,"C",t+i,e,t+i,e,t+i,e+o,"L",t+i,e+r-o,"C",t+i,e+r,t+i,e+r,t+i-o,e+r,"L",t+o,e+r,"C",t,e+r,t,e+r,t,e+r-o,"L",t,e+o,"C",t,e,t,e,t+o,e],h&&h>i?l>e+a&&l<e+r-a?s.splice(13,3,"L",t+i,l-6,t+i+6,l,t+i,l+6,t+i,e+r-o):s.splice(13,3,"L",t+i,r/2,h,l,t+i,r/2,t+i,e+r-o):h&&h<0?l>e+a&&l<e+r-a?s.splice(33,3,"L",t,l+6,t-6,l,t,l-6,t,e+o):s.splice(33,3,"L",t,r/2,h,l,t,r/2,t,e+o):l&&l>r&&h>t+a&&h<t+i-a?s.splice(23,3,"L",h+6,e+r,h,e+r+6,h-6,e+r,t+o,e+r):l&&l<0&&h>t+a&&h<t+i-a&&s.splice(3,3,"L",h-6,e,h,e-6,h+6,e,i-o,e),s}},clipRect:function(t,e,i,r){var n,s=H.uniqueKey()+"-",o=this.createElement("clipPath").attr({id:s}).add(this.defs);return(n=this.rect(t,e,i,r,0).add(o)).id=s,n.clipPath=o,n.count=0,n},text:function(t,e,i,r){var n,s={};return!r||!this.allowHTML&&this.forExport?(s.x=Math.round(e||0),i&&(s.y=Math.round(i)),defined(t)&&(s.text=t),n=this.createElement("text").attr(s),r||(n.xSetter=function(t,e,i){var r,n,s=i.getElementsByTagName("tspan"),o=i.getAttribute(e);for(n=0;n<s.length;n++)(r=s[n]).getAttribute(e)===o&&r.setAttribute(e,t);i.setAttribute(e,t)}),n):this.html(t,e,i)},fontMetrics:function(t,e){var i;return t=!this.styledMode&&/px/.test(t)||!win.getComputedStyle?t||e&&e.style&&e.style.fontSize||this.style&&this.style.fontSize:e&&SVGElement.prototype.getStyle.call(e,"font-size"),{h:i=(t=/px/.test(t)?pInt(t):12)<24?t+3:Math.round(1.2*t),b:Math.round(.8*i),f:t}},rotCorr:function(t,e,i){var r=t;return e&&i&&(r=Math.max(r*Math.cos(e*deg2rad),4)),{x:-t/3*Math.sin(e*deg2rad),y:r}},label:function(t,e,i,r,n,s,o,a,h){var l,d,c,u,f,p,g,m,x,y,S,b,v=this,w=v.styledMode,A=v.g("button"!==h&&"label"),E=A.text=v.text("",0,0,o).attr({zIndex:1}),M=0,C=3,k=0,N={},G=/^url\((.*?)\)$/.test(r),O=w||G,T=function(){return w?l.strokeWidth()%2/2:(m?parseInt(m,10):0)%2/2};h&&A.addClass("highcharts-"+h),y=function(){var t,e=E.element.style,i={};d=(void 0===c||void 0===u||g)&&defined(E.textStr)&&E.getBBox(),A.width=(c||d.width||0)+2*C+k,A.height=(u||d.height||0)+2*C,x=C+Math.min(v.fontMetrics(e&&e.fontSize,E).b,d?d.height:1/0),O&&(l||(A.box=l=v.symbols[r]||G?v.symbol(r):v.rect(),l.addClass(("button"===h?"":"highcharts-label-box")+(h?" highcharts-"+h+"-box":"")),l.add(A),t=T(),i.x=t,i.y=(a?-x:0)+t),i.width=Math.round(A.width),i.height=Math.round(A.height),l.attr(extend(i,N)),N={})},S=function(){var t,e=k+C;t=a?0:x,defined(c)&&d&&("center"===g||"right"===g)&&(e+={center:.5,right:1}[g]*(c-d.width)),e===E.x&&t===E.y||(E.attr("x",e),E.hasBoxWidthChanged&&(d=E.getBBox(!0),y()),void 0!==t&&E.attr("y",t)),E.x=e,E.y=t},b=function(t,e){l?l.attr(t,e):N[t]=e},A.onAdd=function(){E.add(A),A.attr({text:t||0===t?t:"",x:e,y:i}),l&&defined(n)&&A.attr({anchorX:n,anchorY:s})},A.widthSetter=function(t){c=isNumber(t)?t:null},A.heightSetter=function(t){u=t},A["text-alignSetter"]=function(t){g=t},A.paddingSetter=function(t){defined(t)&&t!==C&&(C=A.padding=t,S())},A.paddingLeftSetter=function(t){defined(t)&&t!==k&&(k=t,S())},A.alignSetter=function(t){(t={left:0,center:.5,right:1}[t])!==M&&(M=t,d&&A.attr({x:f}))},A.textSetter=function(t){void 0!==t&&E.attr({text:t}),y(),S()},A["stroke-widthSetter"]=function(t,e){t&&(O=!0),m=this["stroke-width"]=t,b(e,t)},w?A.rSetter=function(t,e){b(e,t)}:A.strokeSetter=A.fillSetter=A.rSetter=function(t,e){"r"!==e&&("fill"===e&&t&&(O=!0),A[e]=t),b(e,t)},A.anchorXSetter=function(t,e){n=A.anchorX=t,b(e,Math.round(t)-T()-f)},A.anchorYSetter=function(t,e){s=A.anchorY=t,b(e,t-p)},A.xSetter=function(t){A.x=t,M&&(t-=M*((c||d.width)+2*C),A["forceAnimate:x"]=!0),f=Math.round(t),A.attr("translateX",f)},A.ySetter=function(t){p=A.y=Math.round(t),A.attr("translateY",p)};var V=A.css,H={css:function(t){if(t){var e={};t=merge(t),A.textProps.forEach(function(i){void 0!==t[i]&&(e[i]=t[i],delete t[i])}),E.css(e),"width"in e&&y(),"fontSize"in e&&(y(),S())}return V.call(A,t)},getBBox:function(){return{width:d.width+2*C,height:d.height+2*C,x:d.x-C,y:d.y-C}},destroy:function(){removeEvent(A.element,"mouseenter"),removeEvent(A.element,"mouseleave"),E&&(E=E.destroy()),l&&(l=l.destroy()),SVGElement.prototype.destroy.call(A),A=v=y=S=b=null}};return w||(H.shadow=function(t){return t&&(y(),l&&l.shadow(t)),A}),extend(A,H)}}),H.Renderer=SVGRenderer;