"use strict";import H from"./Globals.js";import U from"./Utilities.js";var defined=U.defined,destroyObjectProperties=U.destroyObjectProperties,erase=U.erase,extend=U.extend,isArray=U.isArray,isNumber=U.isNumber,pick=U.pick,splat=U.splat;import"./Color.js";import"./Axis.js";import"./Chart.js";import"./Series.js";import"./Options.js";import"./Scrollbar.js";var defaultSeriesType,addEvent=H.addEvent,Axis=H.Axis,Chart=H.Chart,color=H.color,defaultOptions=H.defaultOptions,hasTouch=H.hasTouch,isTouchDevice=H.isTouchDevice,merge=H.merge,removeEvent=H.removeEvent,Scrollbar=H.Scrollbar,Series=H.Series,seriesTypes=H.seriesTypes,numExt=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s=[].filter.call(e,isNumber);if(s.length)return Math[t].apply(0,s)};function Navigator(t){this.init(t)}defaultSeriesType=void 0===seriesTypes.areaspline?"line":"areaspline",extend(defaultOptions,{navigator:{height:40,margin:25,maskInside:!0,handles:{width:7,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:color("#6685c2").setOpacity(.3).get(),outlineColor:"#cccccc",outlineWidth:1,series:{type:defaultSeriesType,fillOpacity:.05,lineWidth:1,compare:null,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2,3,4]],["week",[1,2,3]],["month",[1,3,6]],["year",null]]},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},threshold:null},xAxis:{overscroll:0,className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#999999"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}}),H.Renderer.prototype.symbols["navigator-handle"]=function(t,e,i,s,a){var r=a.width/2,n=Math.round(r/3)+.5,o=a.height;return["M",-r-1,.5,"L",r,.5,"L",r,o+.5,"L",-r-1,o+.5,"L",-r-1,.5,"M",-n,4,"L",-n,o-3,"M",n-1,4,"L",n-1,o-3]},Axis.prototype.toFixedRange=function(t,e,i,s){var a=this.chart&&this.chart.fixedRange,r=(this.pointRange||0)/2,n=pick(i,this.translate(t,!0,!this.horiz)),o=pick(s,this.translate(e,!0,!this.horiz)),h=a&&(o-n)/a;return defined(i)||(n=H.correctFloat(n+r)),defined(s)||(o=H.correctFloat(o-r)),h>.7&&h<1.3&&(s?n=o-a:o=n+a),isNumber(n)&&isNumber(o)||(n=o=void 0),{min:n,max:o}},Navigator.prototype={drawHandle:function(t,e,i,s){var a=this.navigatorOptions.handles.height;this.handles[e][s](i?{translateX:Math.round(this.left+this.height/2),translateY:Math.round(this.top+parseInt(t,10)+.5-a)}:{translateX:Math.round(this.left+parseInt(t,10)),translateY:Math.round(this.top+this.height/2-a/2-1)})},drawOutline:function(t,e,i,s){var a,r,n=this.navigatorOptions.maskInside,o=this.outline.strokeWidth(),h=o/2,d=o%2/2,l=this.outlineHeight,c=this.scrollbarHeight,g=this.size,v=this.left-c,x=this.top;r=i?["M",(v-=h)+l,x-c-d,"L",v+l,a=x+e+d,"L",v,a,"L",v,e=x+t+d,"L",v+l,e,"L",v+l,x+g+c].concat(n?["M",v+l,a-h,"L",v+l,e+h]:[]):["M",v,x+=h,"L",t+=v+c-d,x,"L",t,x+l,"L",e+=v+c-d,x+l,"L",e,x,"L",v+g+2*c,x].concat(n?["M",t-h,x,"L",e+h,x]:[]),this.outline[s]({d:r})},drawMasks:function(t,e,i,s){var a,r,n,o,h=this.left,d=this.top,l=this.height;i?(n=[h,h,h],o=[d,d+t,d+e],r=[l,l,l],a=[t,e-t,this.size-e]):(n=[h,h+t,h+e],o=[d,d,d],r=[t,e-t,this.size-e],a=[l,l,l]),this.shades.forEach(function(t,e){t[s]({x:n[e],y:o[e],width:r[e],height:a[e]})})},renderElements:function(){var t,e=this,i=e.navigatorOptions,s=i.maskInside,a=e.chart,r=a.inverted,n=a.renderer,o={cursor:r?"ns-resize":"ew-resize"};e.navigatorGroup=t=n.g("navigator").attr({zIndex:8,visibility:"hidden"}).add(),[!s,s,!s].forEach(function(s,r){e.shades[r]=n.rect().addClass("highcharts-navigator-mask"+(1===r?"-inside":"-outside")).add(t),a.styledMode||e.shades[r].attr({fill:s?i.maskFill:"rgba(0,0,0,0)"}).css(1===r&&o)}),e.outline=n.path().addClass("highcharts-navigator-outline").add(t),a.styledMode||e.outline.attr({"stroke-width":i.outlineWidth,stroke:i.outlineColor}),i.handles.enabled&&[0,1].forEach(function(s){if(i.handles.inverted=a.inverted,e.handles[s]=n.symbol(i.handles.symbols[s],-i.handles.width/2-1,0,i.handles.width,i.handles.height,i.handles),e.handles[s].attr({zIndex:7-s}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][s]).add(t),!a.styledMode){var r=i.handles;e.handles[s].attr({fill:r.backgroundColor,stroke:r.borderColor,"stroke-width":r.lineWidth}).css(o)}})},update:function(t){(this.series||[]).forEach(function(t){t.baseSeries&&delete t.baseSeries.navigatorSeries}),this.destroy();var e=this.chart.options;merge(!0,e.navigator,this.options,t),this.init(this.chart)},render:function(t,e,i,s){var a,r,n,o,h,d,l,c,g,v,x=this.chart,u=this.scrollbarHeight,p=this.xAxis,m=p.pointRange||0,f=p.fake?x.xAxis[0]:p,b=this.navigatorEnabled,M=this.rendered,E=x.inverted,A=x.xAxis[0].minRange,y=x.xAxis[0].options.maxRange;if(!this.hasDragged||defined(i)){if(t=H.correctFloat(t-m/2),e=H.correctFloat(e+m/2),!isNumber(t)||!isNumber(e)){if(!M)return;i=0,s=pick(p.width,f.width)}this.left=pick(p.left,x.plotLeft+u+(E?x.plotWidth:0)),this.size=d=o=pick(p.len,(E?x.plotHeight:x.plotWidth)-2*u),a=E?u:o+2*u,i=pick(i,p.toPixels(t,!0)),s=pick(s,p.toPixels(e,!0)),isNumber(i)&&Math.abs(i)!==1/0||(i=0,s=a),c=p.toValue(i,!0),g=p.toValue(s,!0),v=Math.abs(H.correctFloat(g-c)),H.correctFloat(v-m)<A?this.grabbedLeft?i=p.toPixels(g-A-m,!0):this.grabbedRight&&(s=p.toPixels(c+A+m,!0)):defined(y)&&H.correctFloat(v-m)>y&&(this.grabbedLeft?i=p.toPixels(g-y-m,!0):this.grabbedRight&&(s=p.toPixels(c+y+m,!0))),this.zoomedMax=Math.min(Math.max(i,s,0),d),this.zoomedMin=Math.min(Math.max(this.fixedWidth?this.zoomedMax-this.fixedWidth:Math.min(i,s),0),d),this.range=this.zoomedMax-this.zoomedMin,d=Math.round(this.zoomedMax),h=Math.round(this.zoomedMin),b&&(this.navigatorGroup.attr({visibility:"visible"}),l=M&&!this.hasDragged?"animate":"attr",this.drawMasks(h,d,E,l),this.drawOutline(h,d,E,l),this.navigatorOptions.handles.enabled&&(this.drawHandle(h,0,E,l),this.drawHandle(d,1,E,l))),this.scrollbar&&(E?(n=this.top-u,r=this.left-u+(b||!f.opposite?0:(f.titleOffset||0)+f.axisTitleMargin),u=o+2*u):(n=this.top+(b?this.height:-u),r=this.left-u),this.scrollbar.position(r,n,a,u),this.scrollbar.setRange(this.zoomedMin/(o||1),this.zoomedMax/(o||1))),this.rendered=!0}},addMouseEvents:function(){var t,e,i=this,s=i.chart,a=s.container,r=[];i.mouseMoveHandler=t=function(t){i.onMouseMove(t)},i.mouseUpHandler=e=function(t){i.onMouseUp(t)},(r=i.getPartsEvents("mousedown")).push(addEvent(s.renderTo,"mousemove",t),addEvent(a.ownerDocument,"mouseup",e)),hasTouch&&(r.push(addEvent(s.renderTo,"touchmove",t),addEvent(a.ownerDocument,"touchend",e)),r.concat(i.getPartsEvents("touchstart"))),i.eventsToUnbind=r,i.series&&i.series[0]&&r.push(addEvent(i.series[0].xAxis,"foundExtremes",function(){s.navigator.modifyNavigatorAxisExtremes()}))},getPartsEvents:function(t){var e=this,i=[];return["shades","handles"].forEach(function(s){e[s].forEach(function(a,r){i.push(addEvent(a.element,t,function(t){e[s+"Mousedown"](t,r)}))})}),i},shadesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i,s,a,r,n=this.chart,o=this.xAxis,h=this.zoomedMin,d=this.left,l=this.size,c=this.range,g=t.chartX;n.inverted&&(g=t.chartY,d=this.top),1===e?(this.grabbedCenter=g,this.fixedWidth=c,this.dragOffset=g-h):(r=g-d-c/2,0===e?r=Math.max(0,r):2===e&&r+c>=l&&(r=l-c,this.reversedExtremes?(r-=c,s=this.getUnionExtremes().dataMin):i=this.getUnionExtremes().dataMax),r!==h&&(this.fixedWidth=c,a=o.toFixedRange(r,r+c,s,i),defined(a.min)&&n.xAxis[0].setExtremes(Math.min(a.min,a.max),Math.max(a.min,a.max),!0,null,{trigger:"navigator"})))},handlesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i=this.chart,s=i.xAxis[0],a=this.reversedExtremes;0===e?(this.grabbedLeft=!0,this.otherHandlePos=this.zoomedMax,this.fixedExtreme=a?s.min:s.max):(this.grabbedRight=!0,this.otherHandlePos=this.zoomedMin,this.fixedExtreme=a?s.max:s.min),i.fixedRange=null},onMouseMove:function(t){var e,i=this,s=i.chart,a=i.left,r=i.navigatorSize,n=i.range,o=i.dragOffset,h=s.inverted;t.touches&&0===t.touches[0].pageX||(e=(t=s.pointer.normalize(t)).chartX,h&&(a=i.top,e=t.chartY),i.grabbedLeft?(i.hasDragged=!0,i.render(0,0,e-a,i.otherHandlePos)):i.grabbedRight?(i.hasDragged=!0,i.render(0,0,i.otherHandlePos,e-a)):i.grabbedCenter&&(i.hasDragged=!0,e<o?e=o:e>r+o-n&&(e=r+o-n),i.render(0,0,e-o,e-o+n)),i.hasDragged&&i.scrollbar&&pick(i.scrollbar.options.liveRedraw,H.svg&&!isTouchDevice&&!this.chart.isBoosting)&&(t.DOMType=t.type,setTimeout(function(){i.onMouseUp(t)},0)))},onMouseUp:function(t){var e,i,s,a,r=this.chart,n=this.xAxis,o=this.scrollbar,h=t.DOMEvent||t;(!this.hasDragged||o&&o.hasDragged)&&"scrollbar"!==t.trigger||(e=this.getUnionExtremes(),this.zoomedMin===this.otherHandlePos?i=this.fixedExtreme:this.zoomedMax===this.otherHandlePos&&(s=this.fixedExtreme),this.zoomedMax===this.size&&(s=this.reversedExtremes?e.dataMin:e.dataMax),0===this.zoomedMin&&(i=this.reversedExtremes?e.dataMax:e.dataMin),a=n.toFixedRange(this.zoomedMin,this.zoomedMax,i,s),defined(a.min)&&r.xAxis[0].setExtremes(Math.min(a.min,a.max),Math.max(a.min,a.max),!0,!this.hasDragged&&null,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:h})),"mousemove"!==t.DOMType&&"touchmove"!==t.DOMType&&(this.grabbedLeft=this.grabbedRight=this.grabbedCenter=this.fixedWidth=this.fixedExtreme=this.otherHandlePos=this.hasDragged=this.dragOffset=null)},removeEvents:function(){this.eventsToUnbind&&(this.eventsToUnbind.forEach(function(t){t()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()},removeBaseSeriesEvents:function(){var t=this.baseSeries||[];this.navigatorEnabled&&t[0]&&(!1!==this.navigatorOptions.adaptToUpdatedData&&t.forEach(function(t){removeEvent(t,"updatedData",this.updatedDataHandler)},this),t[0].xAxis&&removeEvent(t[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))},init:function(t){var e=t.options,i=e.navigator,s=i.enabled,a=e.scrollbar,r=a.enabled,n=s?i.height:0,o=r?a.height:0;this.handles=[],this.shades=[],this.chart=t,this.setBaseSeries(),this.height=n,this.scrollbarHeight=o,this.scrollbarEnabled=r,this.navigatorEnabled=s,this.navigatorOptions=i,this.scrollbarOptions=a,this.outlineHeight=n+o,this.opposite=pick(i.opposite,Boolean(!s&&t.inverted));var h=this,d=h.baseSeries,l=t.xAxis.length,c=t.yAxis.length,g=d&&d[0]&&d[0].xAxis||t.xAxis[0]||{options:{}};t.isDirtyBox=!0,h.navigatorEnabled?(h.xAxis=new Axis(t,merge({breaks:g.options.breaks,ordinal:g.options.ordinal},i.xAxis,{id:"navigator-x-axis",yAxis:"navigator-y-axis",isX:!0,type:"datetime",index:l,isInternal:!0,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1},t.inverted?{offsets:[o,0,-o,0],width:n}:{offsets:[0,-o,0,o],height:n})),h.yAxis=new Axis(t,merge(i.yAxis,{id:"navigator-y-axis",alignTicks:!1,offset:0,index:c,isInternal:!0,zoomEnabled:!1},t.inverted?{width:n}:{height:n})),d||i.series.data?h.updateNavigatorSeries(!1):0===t.series.length&&(h.unbindRedraw=addEvent(t,"beforeRedraw",function(){t.series.length>0&&!h.series&&(h.setBaseSeries(),h.unbindRedraw())})),h.reversedExtremes=t.inverted&&!h.xAxis.reversed||!t.inverted&&h.xAxis.reversed,h.renderElements(),h.addMouseEvents()):h.xAxis={translate:function(e,i){var s=t.xAxis[0],a=s.getExtremes(),r=s.len-2*o,n=numExt("min",s.options.min,a.dataMin),h=numExt("max",s.options.max,a.dataMax)-n;return i?e*h/r+n:r*(e-n)/h},toPixels:function(t){return this.translate(t)},toValue:function(t){return this.translate(t,!0)},toFixedRange:Axis.prototype.toFixedRange,fake:!0},t.options.scrollbar.enabled&&(t.scrollbar=h.scrollbar=new Scrollbar(t.renderer,merge(t.options.scrollbar,{margin:h.navigatorEnabled?0:10,vertical:t.inverted}),t),addEvent(h.scrollbar,"changed",function(e){var i=h.size,s=i*this.to,a=i*this.from;h.hasDragged=h.scrollbar.hasDragged,h.render(0,0,a,s),(t.options.scrollbar.liveRedraw||"mousemove"!==e.DOMType&&"touchmove"!==e.DOMType)&&setTimeout(function(){h.onMouseUp(e)})})),h.addBaseSeriesEvents(),h.addChartEvents()},getUnionExtremes:function(t){var e,i=this.chart.xAxis[0],s=this.xAxis,a=s.options,r=i.options;return t&&null===i.dataMin||(e={dataMin:pick(a&&a.min,numExt("min",r.min,i.dataMin,s.dataMin,s.min)),dataMax:pick(a&&a.max,numExt("max",r.max,i.dataMax,s.dataMax,s.max))}),e},setBaseSeries:function(t,e){var i=this.chart,s=this.baseSeries=[];t=t||i.options&&i.options.navigator.baseSeries||(i.series.length?H.find(i.series,function(t){return!t.options.isInternal}).index:0),(i.series||[]).forEach(function(e,i){e.options.isInternal||!e.options.showInNavigator&&(i!==t&&e.options.id!==t||!1===e.options.showInNavigator)||s.push(e)}),this.xAxis&&!this.xAxis.fake&&this.updateNavigatorSeries(!0,e)},updateNavigatorSeries:function(t,e){var i,s,a,r=this,n=r.chart,o=r.baseSeries,h=r.navigatorOptions.series,d={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",showInLegend:!1,stacking:!1,isInternal:!0,states:{inactive:{opacity:1}}},l=r.series=(r.series||[]).filter(function(t){var e=t.baseSeries;return!(o.indexOf(e)<0)||(e&&(removeEvent(e,"updatedData",r.updatedDataHandler),delete e.navigatorSeries),t.chart&&t.destroy(),!1)});o&&o.length&&o.forEach(function(t){var c=t.navigatorSeries,g=extend({color:t.color,visible:t.visible},isArray(h)?defaultOptions.navigator.series:h);if(!c||!1!==r.navigatorOptions.adaptToUpdatedData){d.name="Navigator "+o.length,i=t.options||{},a=i.navigatorOptions||{},(s=merge(i,d,g,a)).pointRange=pick(g.pointRange,a.pointRange,defaultOptions.plotOptions[s.type||"line"].pointRange);var v=a.data||g.data;r.hasNavigatorData=r.hasNavigatorData||!!v,s.data=v||i.data&&i.data.slice(0),c&&c.options?c.update(s,e):(t.navigatorSeries=n.initSeries(s),t.navigatorSeries.baseSeries=t,l.push(t.navigatorSeries))}}),(!h.data||o&&o.length)&&!isArray(h)||(r.hasNavigatorData=!1,(h=splat(h)).forEach(function(t,e){d.name="Navigator "+(l.length+1),(s=merge(defaultOptions.navigator.series,{color:n.series[e]&&!n.series[e].options.isInternal&&n.series[e].color||n.options.colors[e]||n.options.colors[0]},d,t)).data=t.data,s.data&&(r.hasNavigatorData=!0,l.push(n.initSeries(s)))})),t&&this.addBaseSeriesEvents()},addBaseSeriesEvents:function(){var t=this,e=t.baseSeries||[];e[0]&&e[0].xAxis&&addEvent(e[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes),e.forEach(function(e){addEvent(e,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)}),addEvent(e,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)}),!1!==this.navigatorOptions.adaptToUpdatedData&&e.xAxis&&addEvent(e,"updatedData",this.updatedDataHandler),addEvent(e,"remove",function(){this.navigatorSeries&&(erase(t.series,this.navigatorSeries),defined(this.navigatorSeries.options)&&this.navigatorSeries.remove(!1),delete this.navigatorSeries)})},this)},getBaseSeriesMin:function(t){return this.baseSeries.reduce(function(t,e){return Math.min(t,e.xData?e.xData[0]:t)},t)},modifyNavigatorAxisExtremes:function(){var t,e=this.xAxis;void 0!==e.getExtremes&&(!(t=this.getUnionExtremes(!0))||t.dataMin===e.min&&t.dataMax===e.max||(e.min=t.dataMin,e.max=t.dataMax))},modifyBaseAxisExtremes:function(){var t,e,i=this.chart.navigator,s=this.getExtremes(),a=s.min,r=s.max,n=s.dataMin,o=s.dataMax,h=r-a,d=i.stickToMin,l=i.stickToMax,c=pick(this.options.overscroll,0),g=i.series&&i.series[0],v=!!this.setExtremes;this.eventArgs&&"rangeSelectorButton"===this.eventArgs.trigger||(d&&(t=(e=n)+h),l&&(t=o+c,d||(e=Math.max(t-h,i.getBaseSeriesMin(g&&g.xData?g.xData[0]:-Number.MAX_VALUE)))),v&&(d||l)&&isNumber(e)&&(this.min=this.userMin=e,this.max=this.userMax=t)),i.stickToMin=i.stickToMax=null},updatedDataHandler:function(){var t=this.chart.navigator,e=this.navigatorSeries,i=t.getBaseSeriesMin(this.xData[0]);t.stickToMax=t.reversedExtremes?0===Math.round(t.zoomedMin):Math.round(t.zoomedMax)>=Math.round(t.size),t.stickToMin=isNumber(this.xAxis.min)&&this.xAxis.min<=i&&(!this.chart.fixedRange||!t.stickToMax),e&&!t.hasNavigatorData&&(e.options.pointStart=this.xData[0],e.setData(this.options.data,!1,null,!1))},addChartEvents:function(){this.eventsToUnbind||(this.eventsToUnbind=[]),this.eventsToUnbind.push(addEvent(this.chart,"redraw",function(){var t=this.navigator,e=t&&(t.baseSeries&&t.baseSeries[0]&&t.baseSeries[0].xAxis||t.scrollbar&&this.xAxis[0]);e&&t.render(e.min,e.max)}),addEvent(this.chart,"getMargins",function(){var t=this.navigator,e=t.opposite?"plotTop":"marginBottom";this.inverted&&(e=t.opposite?"marginRight":"plotLeft"),this[e]=(this[e]||0)+(t.navigatorEnabled||!this.inverted?t.outlineHeight:0)+t.navigatorOptions.margin}))},destroy:function(){this.removeEvents(),this.xAxis&&(erase(this.chart.xAxis,this.xAxis),erase(this.chart.axes,this.xAxis)),this.yAxis&&(erase(this.chart.yAxis,this.yAxis),erase(this.chart.axes,this.yAxis)),(this.series||[]).forEach(function(t){t.destroy&&t.destroy()}),["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"].forEach(function(t){this[t]&&this[t].destroy&&this[t].destroy(),this[t]=null},this),[this.handles].forEach(function(t){destroyObjectProperties(t)},this)}},H.Navigator||(H.Navigator=Navigator,addEvent(Axis,"zoom",function(t){var e,i=this.chart.options,s=i.chart.zoomType,a=i.chart.pinchType,r=i.navigator,n=i.rangeSelector;this.isXAxis&&(r&&r.enabled||n&&n.enabled)&&("y"===s?t.zoomed=!1:(!isTouchDevice&&"xy"===s||isTouchDevice&&"xy"===a)&&this.options.range&&(e=this.previousZoom,defined(t.newMin)?this.previousZoom=[this.min,this.max]:e&&(t.newMin=e[0],t.newMax=e[1],delete this.previousZoom))),void 0!==t.zoomed&&t.preventDefault()}),addEvent(Chart,"beforeShowResetZoom",function(){var t=this.options,e=t.navigator,i=t.rangeSelector;if((e&&e.enabled||i&&i.enabled)&&(!isTouchDevice&&"x"===t.chart.zoomType||isTouchDevice&&"x"===t.chart.pinchType))return!1}),addEvent(Chart,"beforeRender",function(){var t=this.options;(t.navigator.enabled||t.scrollbar.enabled)&&(this.scroller=this.navigator=new Navigator(this))}),addEvent(Chart,"afterSetChartSize",function(){var t,e,i,s,a=this.legend,r=this.navigator;r&&(e=a&&a.options,i=r.xAxis,s=r.yAxis,t=r.scrollbarHeight,this.inverted?(r.left=r.opposite?this.chartWidth-t-r.height:this.spacing[3]+t,r.top=this.plotTop+t):(r.left=this.plotLeft+t,r.top=r.navigatorOptions.top||this.chartHeight-r.height-t-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(e&&"bottom"===e.verticalAlign&&e.enabled&&!e.floating?a.legendHeight+pick(e.margin,10):0)-(this.titleOffset?this.titleOffset[2]:0)),i&&s&&(this.inverted?i.options.left=s.options.left=r.left:i.options.top=s.options.top=r.top,i.setAxisSize(),s.setAxisSize()))}),addEvent(Chart,"update",function(t){var e=t.options.navigator||{},i=t.options.scrollbar||{};this.navigator||this.scroller||!e.enabled&&!i.enabled||(merge(!0,this.options.navigator,e),merge(!0,this.options.scrollbar,i),delete t.options.navigator,delete t.options.scrollbar)}),addEvent(Chart,"afterUpdate",function(t){this.navigator||this.scroller||!this.options.navigator.enabled&&!this.options.scrollbar.enabled||(this.scroller=this.navigator=new Navigator(this),pick(t.redraw,!0)&&this.redraw(t.animation))}),addEvent(Chart,"afterAddSeries",function(){this.navigator&&this.navigator.setBaseSeries(null,!1)}),addEvent(Series,"afterUpdate",function(){this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1)}),Chart.prototype.callbacks.push(function(t){var e,i=t.navigator;i&&t.xAxis[0]&&(e=t.xAxis[0].getExtremes(),i.render(e.min,e.max))}));