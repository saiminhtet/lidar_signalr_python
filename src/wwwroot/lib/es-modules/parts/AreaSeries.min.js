"use strict";import H from"./Globals.js";import U from"./Utilities.js";var objectEach=U.objectEach,pick=U.pick;import"./Color.js";import"./Legend.js";import"./Series.js";import"./Options.js";var color=H.color,LegendSymbolMixin=H.LegendSymbolMixin,Series=H.Series,seriesType=H.seriesType;seriesType("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(t){var i,e,s=[],o=[],l=this.xAxis,r=this.yAxis,a=r.stacks[this.stackKey],h={},n=this.index,p=r.series,c=p.length,f=pick(r.options.reversedStacks,!0)?1:-1;if(t=t||this.points,this.options.stacking){for(e=0;e<t.length;e++)t[e].leftNull=t[e].rightNull=void 0,h[t[e].x]=t[e];objectEach(a,function(t,i){null!==t.total&&o.push(i)}),o.sort(function(t,i){return t-i}),i=p.map(function(t){return t.visible}),o.forEach(function(t,p){var u,d,g=0;if(h[t]&&!h[t].isNull)s.push(h[t]),[-1,1].forEach(function(s){var l=1===s?"rightNull":"leftNull",r=1===s?"rightCliff":"leftCliff",g=0,k=a[o[p+s]];if(k)for(e=n;e>=0&&e<c;)(u=k.points[e])||(e===n?h[t][l]=!0:i[e]&&(d=a[t].points[e])&&(g-=d[1]-d[0])),e+=f;h[t][r]=g});else{for(e=n;e>=0&&e<c;){if(u=a[t].points[e]){g=u[1];break}e+=f}g=r.translate(g,0,1,0,1),s.push({isNull:!0,plotX:l.translate(t,0,0,0,1),x:t,plotY:g,yBottom:g})}})}return s},getGraphPath:function(t){var i,e,s,o,l,r,a,h,n=Series.prototype.getGraphPath,p=this.options,c=p.stacking,f=this.yAxis,u=[],d=[],g=this.index,k=f.stacks[this.stackKey],m=p.threshold,y=Math.round(f.getThreshold(p.threshold)),x=pick(p.connectNulls,"percent"===c),v=function(i,e,s){var o,l,a=t[i],h=c&&k[a.x].points[g],n=a[s+"Null"]||0,p=a[s+"Cliff"]||0,x=!0;p||n?(o=(n?h[0]:h[1])+p,l=h[0]+p,x=!!n):!c&&t[e]&&t[e].isNull&&(o=l=m),void 0!==o&&(d.push({plotX:r,plotY:null===o?y:f.getThreshold(o),isNull:x,isCliff:!0}),u.push({plotX:r,plotY:null===l?y:f.getThreshold(l),doCurve:!1}))};for(t=t||this.points,c&&(t=this.getStackPoints(t)),o=0;o<t.length;o++)c||(t[o].leftCliff=t[o].rightCliff=t[o].leftNull=t[o].rightNull=void 0),a=t[o].isNull,r=pick(t[o].rectPlotX,t[o].plotX),h=pick(t[o].yBottom,y),a&&!x||(x||v(o,o-1,"left"),a&&!c&&x||(d.push(t[o]),u.push({x:o,plotX:r,plotY:h})),x||v(o,o+1,"right"));return e=n.call(this,d,!0,!0),u.reversed=!0,(s=n.call(this,u,!0,!0)).length&&(s[0]="L"),l=e.concat(s),i=n.call(this,d,!1,x),l.xMap=e.xMap,this.areaPath=l,i},drawGraph:function(){this.areaPath=[],Series.prototype.drawGraph.apply(this);var t=this,i=this.areaPath,e=this.options,s=this.zones,o=[["area","highcharts-area",this.color,e.fillColor]];s.forEach(function(i,s){o.push(["zone-area-"+s,"highcharts-area highcharts-zone-area-"+s+" "+i.className,i.color||t.color,i.fillColor||e.fillColor])}),o.forEach(function(s){var o=s[0],l=t[o],r=l?"animate":"attr",a={};l?(l.endX=t.preventGraphAnimation?null:i.xMap,l.animate({d:i})):(a.zIndex=0,(l=t[o]=t.chart.renderer.path(i).addClass(s[1]).add(t.group)).isArea=!0),t.chart.styledMode||(a.fill=pick(s[3],color(s[2]).setOpacity(pick(e.fillOpacity,.75)).get())),l[r](a),l.startX=i.xMap,l.shiftUnit=e.step?2:1})},drawLegendSymbol:LegendSymbolMixin.drawRectangle});