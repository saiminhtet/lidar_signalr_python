"use strict";import H from"../parts/Globals.js";import"../parts/Utilities.js";import multipleLinesMixin from"../mixins/multipe-lines.js";var SMA=H.seriesTypes.sma,merge=H.merge,correctFloat=H.correctFloat;function getBaseForBand(t,e,a){return correctFloat(e-t)/(correctFloat(e+t)/2)*1e3*a}function getPointUB(t,e){return t*correctFloat(1+2*e)}function getPointLB(t,e){return t*correctFloat(1-2*e)}H.seriesType("abands","sma",{params:{period:20,factor:.001,index:3},lineWidth:1,topLine:{styles:{lineWidth:1}},bottomLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}},merge(multipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameBase:"Acceleration Bands",nameComponents:["period","factor"],linesApiNames:["topLine","bottomLine"],getValues:function(t,e){var a,i,o,r,s,n,l,p,c,m,u,d=e.period,y=e.factor,g=e.index,D=t.xData,x=t.yData,h=x?x.length:0,f=[],B=[],F=[],L=[],A=[];if(h<d)return!1;for(u=0;u<=h;u++)u<h&&(s=getBaseForBand(x[u][2],x[u][1],y),f.push(getPointUB(x[u][1],s)),B.push(getPointLB(x[u][2],s))),u>=d&&(c=D.slice(u-d,u),m=x.slice(u-d,u),l=SMA.prototype.getValues.call(this,{xData:c,yData:f.slice(u-d,u)},{period:d}),p=SMA.prototype.getValues.call(this,{xData:c,yData:B.slice(u-d,u)},{period:d}),r=(n=SMA.prototype.getValues.call(this,{xData:c,yData:m},{period:d,index:g})).xData[0],i=l.yData[0],o=p.yData[0],a=n.yData[0],F.push([r,i,a,o]),L.push(r),A.push([i,a,o]));return{values:F,xData:L,yData:A}}}));