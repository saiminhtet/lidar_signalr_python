"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var extend=U.extend,objectEach=U.objectEach,pick=U.pick;import"../parts/Chart.js";var addEvent=H.addEvent,Chart=H.Chart,doc=H.doc,merge=H.merge;function stopEvent(t){t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)}function MapNavigation(t){this.init(t)}MapNavigation.prototype.init=function(t){this.chart=t,t.mapNavButtons=[]},MapNavigation.prototype.update=function(t){var i,e,n,o,a,s=this.chart,h=s.options.mapNavigation,d=function(t){this.handler.call(s,t),stopEvent(t)},r=s.mapNavButtons;for(t&&(h=s.options.mapNavigation=merge(s.options.mapNavigation,t));r.length;)r.pop().destroy();pick(h.enableButtons,h.enabled)&&!s.renderer.forExport&&objectEach(h.buttons,function(t,p){i=merge(h.buttonOptions,t),s.styledMode||((e=i.theme).style=merge(i.theme.style,i.style),n=e.states,o=n&&n.hover,a=n&&n.select),(t=s.renderer.button(i.text,0,0,d,e,o,a,0,"zoomIn"===p?"topbutton":"bottombutton").addClass("highcharts-map-navigation highcharts-"+{zoomIn:"zoom-in",zoomOut:"zoom-out"}[p]).attr({width:i.width,height:i.height,title:s.options.lang[p],padding:i.padding,zIndex:5}).add()).handler=i.onclick,t.align(extend(i,{width:t.width,height:2*t.height}),null,i.alignTo),addEvent(t.element,"dblclick",stopEvent),r.push(t)}),this.updateEvents(h)},MapNavigation.prototype.updateEvents=function(t){var i=this.chart;pick(t.enableDoubleClickZoom,t.enabled)||t.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||addEvent(i.container,"dblclick",function(t){i.pointer.onContainerDblClick(t)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick()),pick(t.enableMouseWheelZoom,t.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||addEvent(i.container,void 0===doc.onmousewheel?"DOMMouseScroll":"mousewheel",function(t){return i.pointer.onContainerMouseWheel(t),stopEvent(t),!1}):this.unbindMouseWheel&&(this.unbindMouseWheel=this.unbindMouseWheel())},extend(Chart.prototype,{fitToBox:function(t,i){return[["x","width"],["y","height"]].forEach(function(e){var n=e[0],o=e[1];t[n]+t[o]>i[n]+i[o]&&(t[o]>i[o]?(t[o]=i[o],t[n]=i[n]):t[n]=i[n]+i[o]-t[o]),t[o]>i[o]&&(t[o]=i[o]),t[n]<i[n]&&(t[n]=i[n])}),t},mapZoom:function(t,i,e,n,o){var a=this.xAxis[0],s=a.max-a.min,h=pick(i,a.min+s/2),d=s*t,r=this.yAxis[0],p=r.max-r.min,l=pick(e,r.min+p/2),c=p*t,u=h-d*(n?(n-a.pos)/a.len:.5),m=l-c*(o?(o-r.pos)/r.len:.5),v=this.fitToBox({x:u,y:m,width:d,height:c},{x:a.dataMin,y:r.dataMin,width:a.dataMax-a.dataMin,height:r.dataMax-r.dataMin}),b=v.x<=a.dataMin&&v.width>=a.dataMax-a.dataMin&&v.y<=r.dataMin&&v.height>=r.dataMax-r.dataMin;n&&(a.fixTo=[n-a.pos,i]),o&&(r.fixTo=[o-r.pos,e]),void 0===t||b?(a.setExtremes(void 0,void 0,!1),r.setExtremes(void 0,void 0,!1)):(a.setExtremes(v.x,v.x+v.width,!1),r.setExtremes(v.y,v.y+v.height,!1)),this.redraw()}}),addEvent(Chart,"beforeRender",function(){this.mapNavigation=new MapNavigation(this),this.mapNavigation.update()}),H.MapNavigation=MapNavigation;