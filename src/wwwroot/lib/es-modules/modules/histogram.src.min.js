"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var arrayMax=U.arrayMax,arrayMin=U.arrayMin,isNumber=U.isNumber,objectEach=U.objectEach;import derivedSeriesMixin from"../mixins/derived-series.js";var seriesType=H.seriesType,correctFloat=H.correctFloat,merge=H.merge,binsNumberFormulas={"square-root":function(t){return Math.ceil(Math.sqrt(t.options.data.length))},sturges:function(t){return Math.ceil(Math.log(t.options.data.length)*Math.LOG2E)},rice:function(t){return Math.ceil(2*Math.pow(t.options.data.length,1/3))}};function fitToBinLeftClosed(t){return function(r){for(var e=1;t[e]<=r;)e++;return t[--e]}}seriesType("histogram","column",{binsNumber:"square-root",binWidth:void 0,pointPadding:0,groupPadding:0,grouping:!1,pointPlacement:"between",tooltip:{headerFormat:"",pointFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/><span style="color:{point.color}">‚óè</span> {series.name} <b>{point.y}</b><br/>'}},merge(derivedSeriesMixin,{setDerivedData:function(){var t=this.baseSeries.yData;if(t.length){var r=this.derivedData(t,this.binsNumber(),this.options.binWidth);this.setData(r,!1)}},derivedData:function(t,r,e){var i,o,a=arrayMax(t),n=correctFloat(arrayMin(t)),s=[],c={},u=[];for(e=this.binWidth=this.options.pointRange=correctFloat(isNumber(e)?e||1:(a-n)/r),i=n;i<a&&(this.userOptions.binWidth||correctFloat(a-i)>=e||correctFloat(n+s.length*e-i)<=0);i=correctFloat(i+e))s.push(i),c[i]=0;return 0!==c[n]&&(s.push(correctFloat(n)),c[correctFloat(n)]=0),o=fitToBinLeftClosed(s.map(function(t){return parseFloat(t)})),t.forEach(function(t){var r=correctFloat(o(t));c[r]++}),objectEach(c,function(t,r){u.push({x:Number(r),y:t,x2:correctFloat(Number(r)+e)})}),u.sort(function(t,r){return t.x-r.x}),u},binsNumber:function(){var t=this.options.binsNumber,r=binsNumberFormulas[t]||"function"==typeof t&&t;return Math.ceil(r&&r(this.baseSeries)||(isNumber(t)?t:binsNumberFormulas["square-root"](this.baseSeries)))}}));