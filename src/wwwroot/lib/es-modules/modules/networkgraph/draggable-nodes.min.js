import H from"../../parts/Globals.js";var Chart=H.Chart,addEvent=H.addEvent;H.dragNodesMixin={onMouseDown:function(t,o){var i=this.chart.pointer.normalize(o);t.fixedPosition={chartX:i.chartX,chartY:i.chartY,plotX:t.plotX,plotY:t.plotY},t.inDragMode=!0},onMouseMove:function(t,o){if(t.fixedPosition&&t.inDragMode){var i,e,a=this.chart,n=a.pointer.normalize(o),s=t.fixedPosition.chartX-n.chartX,r=t.fixedPosition.chartY-n.chartY;(Math.abs(s)>5||Math.abs(r)>5)&&(i=t.fixedPosition.plotX-s,e=t.fixedPosition.plotY-r,a.isInsidePlot(i,e)&&(t.plotX=i,t.plotY=e,t.hasDragged=!0,this.redrawHalo(t),this.layout.simulation?this.layout.resetSimulation():(this.layout.setInitialRendering(!1),this.layout.enableSimulation?this.layout.start():this.layout.setMaxIterations(1),this.chart.redraw(),this.layout.setInitialRendering(!0))))}},onMouseUp:function(t,o){t.fixedPosition&&t.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw(),t.inDragMode=t.hasDragged=!1,this.options.fixedDraggable||delete t.fixedPosition)},redrawHalo:function(t){t&&this.halo&&this.halo.attr({d:t.haloPath(this.options.states.hover.halo.size)})}},addEvent(Chart,"load",function(){var t,o,i,e=this;e.container&&(t=addEvent(e.container,"mousedown",function(t){var a=e.hoverPoint;a&&a.series&&a.series.hasDraggableNodes&&a.series.options.draggable&&(a.series.onMouseDown(a,t),o=addEvent(e.container,"mousemove",function(t){return a&&a.series&&a.series.onMouseMove(a,t)}),i=addEvent(e.container.ownerDocument,"mouseup",function(t){return o(),i(),a&&a.series&&a.series.onMouseUp(a,t)}))})),addEvent(e,"destroy",function(){t()})});