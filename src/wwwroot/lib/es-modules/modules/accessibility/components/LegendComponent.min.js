"use strict";import H from"../../../parts/Globals.js";import U from"../../../parts/Utilities.js";var extend=U.extend;import AccessibilityComponent from"../AccessibilityComponent.js";import KeyboardNavigationHandler from"../KeyboardNavigationHandler.js";import A11yUtilities from"../utilities.js";var stripHTMLTags=A11yUtilities.stripHTMLTagsFromString;H.Chart.prototype.highlightLegendItem=function(e){var t=this.legend.allItems,i=this.highlightedLegendItemIx;return!!t[e]&&(t[i]&&H.fireEvent(t[i].legendGroup.element,"mouseout"),void 0!==t[e].pageIx&&t[e].pageIx+1!==this.legend.currentPage&&this.legend.scroll(1+t[e].pageIx-this.legend.currentPage),this.setFocusToElement(t[e].legendItem,t[e].a11yProxyElement),H.fireEvent(t[e].legendGroup.element,"mouseover"),!0)},H.addEvent(H.Legend,"afterColorizeItem",function(e){var t=this.chart.options.accessibility,i=e.item;t.enabled&&i&&i.a11yProxyElement&&i.a11yProxyElement.setAttribute("aria-pressed",e.visible?"false":"true")});var LegendComponent=function(){};LegendComponent.prototype=new AccessibilityComponent,extend(LegendComponent.prototype,{onChartRender:function(){var e=this.chart,t=e.options.accessibility,i=e.legend&&e.legend.allItems,n=this;n.legendProxyButtonClicked?delete n.legendProxyButtonClicked:(this.removeElement(this.legendProxyGroup),!i||!i.length||e.colorAxis&&e.colorAxis.length||!e.options.legend.accessibility.enabled||(this.legendProxyGroup=this.addProxyGroup({"aria-label":e.langFormat("accessibility.legendLabel"),role:"all"===t.landmarkVerbosity?"region":null}),i.forEach(function(t){t.legendItem&&t.legendItem.element&&(t.a11yProxyElement=n.createProxyButton(t.legendItem,n.legendProxyGroup,{tabindex:-1,"aria-pressed":!t.visible,"aria-label":e.langFormat("accessibility.legendItem",{chart:e,itemName:stripHTMLTags(t.name)})},t.legendGroup.div?t.legendItem:t.legendGroup,function(){n.legendProxyButtonClicked=!0}))})))},getKeyboardNavigation:function(){var e=this.keyCodes,t=this,i=this.chart,n=i.options.accessibility;return new KeyboardNavigationHandler(i,{keyCodeMap:[[[e.left,e.right,e.up,e.down],function(o){var l=o===e.left||o===e.up?-1:1;return i.highlightLegendItem(t.highlightedLegendItemIx+l)?(t.highlightedLegendItemIx+=l,this.response.success):i.legend.allItems.length>1&&n.keyboardNavigation.wrapAround?(this.init(l),this.response.success):this.response[l>0?"next":"prev"]}],[[e.enter,e.space],function(){var e=i.legend.allItems[t.highlightedLegendItemIx];return e&&e.a11yProxyElement&&H.fireEvent(e.a11yProxyElement,"click"),this.response.success}]],validate:function(){var e=i.options.legend;return i.legend&&i.legend.allItems&&i.legend.display&&!(i.colorAxis&&i.colorAxis.length)&&e&&e.accessibility&&e.accessibility.enabled&&e.accessibility.keyboardNavigation&&e.accessibility.keyboardNavigation.enabled},init:function(e){var n=e>0?0:i.legend.allItems.length-1;i.highlightLegendItem(n),t.highlightedLegendItemIx=n}})}});export default LegendComponent;