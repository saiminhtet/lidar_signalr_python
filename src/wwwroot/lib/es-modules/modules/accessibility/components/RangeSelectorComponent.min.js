"use strict";import H from"../../../parts/Globals.js";import U from"../../../parts/Utilities.js";var extend=U.extend;import AccessibilityComponent from"../AccessibilityComponent.js";import KeyboardNavigationHandler from"../KeyboardNavigationHandler.js";H.Chart.prototype.highlightRangeSelectorButton=function(t){var e=this.rangeSelector.buttons;return e[this.highlightedRangeSelectorItemIx]&&e[this.highlightedRangeSelectorItemIx].setState(this.oldRangeSelectorItemState||0),this.highlightedRangeSelectorItemIx=t,!!e[t]&&(this.setFocusToElement(e[t].box,e[t].element),this.oldRangeSelectorItemState=e[t].state,e[t].setState(2),!0)};var RangeSelectorComponent=function(){};RangeSelectorComponent.prototype=new AccessibilityComponent,extend(RangeSelectorComponent.prototype,{onChartUpdate:function(){var t=this.chart,e=this,n=t.rangeSelector;n&&(n.buttons&&n.buttons.length&&n.buttons.forEach(function(n){e.unhideElementFromScreenReaders(n.element),n.element.setAttribute("tabindex","-1"),n.element.setAttribute("role","button"),n.element.setAttribute("aria-label",t.langFormat("accessibility.rangeSelectorButton",{chart:t,buttonText:n.text&&n.text.textStr}))}),n.maxInput&&n.minInput&&["minInput","maxInput"].forEach(function(i,o){n[i]&&(e.unhideElementFromScreenReaders(n[i]),n[i].setAttribute("tabindex","-1"),n[i].setAttribute("role","textbox"),n[i].setAttribute("aria-label",t.langFormat("accessibility.rangeSelector"+(o?"MaxInput":"MinInput"),{chart:t})))}))},getRangeSelectorButtonNavigation:function(){var t=this.chart,e=this.keyCodes,n=t.options.accessibility,i=this;return new KeyboardNavigationHandler(t,{keyCodeMap:[[[e.left,e.right,e.up,e.down],function(i){var o=i===e.left||i===e.up?-1:1;if(!t.highlightRangeSelectorButton(t.highlightedRangeSelectorItemIx+o))return n.keyboardNavigation.wrapAround?(this.init(o),this.response.success):this.response[o>0?"next":"prev"]}],[[e.enter,e.space],function(){3!==t.oldRangeSelectorItemState&&i.fakeClickEvent(t.rangeSelector.buttons[t.highlightedRangeSelectorItemIx].element)}]],validate:function(){return t.rangeSelector&&t.rangeSelector.buttons&&t.rangeSelector.buttons.length},init:function(e){t.highlightRangeSelectorButton(e>0?0:t.rangeSelector.buttons.length-1)}})},getRangeSelectorInputNavigation:function(){var t=this.chart,e=this.keyCodes;return new KeyboardNavigationHandler(t,{keyCodeMap:[[[e.tab,e.up,e.down],function(n,i){var o=n===e.tab&&i.shiftKey||n===e.up?-1:1,r=t.highlightedInputRangeIx=t.highlightedInputRangeIx+o;return r>1||r<0?this.response[o>0?"next":"prev"]:(t.rangeSelector[r?"maxInput":"minInput"].focus(),this.response.success)}]],validate:function(){return t.rangeSelector&&t.rangeSelector.inputGroup&&"hidden"!==t.rangeSelector.inputGroup.element.getAttribute("visibility")&&!1!==t.options.rangeSelector.inputEnabled&&t.rangeSelector.minInput&&t.rangeSelector.maxInput},init:function(e){t.highlightedInputRangeIx=e>0?0:1,t.rangeSelector[t.highlightedInputRangeIx?"maxInput":"minInput"].focus()},terminate:function(){var e=t.rangeSelector;e&&e.maxInput&&e.minInput&&(e.hideInput("max"),e.hideInput("min"))}})},getKeyboardNavigation:function(){return[this.getRangeSelectorButtonNavigation(),this.getRangeSelectorInputNavigation()]}});export default RangeSelectorComponent;