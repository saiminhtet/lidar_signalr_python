"use strict";import H from"../../../parts/Globals.js";import U from"../../../parts/Utilities.js";var extend=U.extend;import AccessibilityComponent from"../AccessibilityComponent.js";import KeyboardNavigationHandler from"../KeyboardNavigationHandler.js";H.Axis.prototype.panStep=function(t,e){var o=e||3,n=this.getExtremes(),a=(n.max-n.min)/o*t,i=n.max+a,r=n.min+a,s=i-r;t<0&&r<n.dataMin?i=(r=n.dataMin)+s:t>0&&i>n.dataMax&&(r=(i=n.dataMax)-s),this.setExtremes(r,i)};var ZoomComponent=function(){};ZoomComponent.prototype=new AccessibilityComponent,extend(ZoomComponent.prototype,{init:function(){var t=this,e=this.chart;["afterShowResetZoom","afterDrilldown","drillupall"].forEach(function(o){t.addEvent(e,o,function(){t.updateProxyOverlays()})})},onChartUpdate:function(){var t=this.chart,e=this;t.mapNavButtons&&t.mapNavButtons.forEach(function(o,n){e.unhideElementFromScreenReaders(o.element),o.element.setAttribute("tabindex",-1),o.element.setAttribute("role","button"),o.element.setAttribute("aria-label",t.langFormat("accessibility.mapZoom"+(n?"Out":"In"),{chart:t}))})},onChartRender:function(){this.updateProxyOverlays()},updateProxyOverlays:function(){var t=this,e=this.chart,o=function(e,o,n,a){t.removeElement(t[n]),t[n]=t.addProxyGroup(),t[o]=t.createProxyButton(e,t[n],{"aria-label":a,tabindex:-1})};t.removeElement(t.drillUpProxyGroup),t.removeElement(t.resetZoomProxyGroup),e.resetZoomButton&&o(e.resetZoomButton,"resetZoomProxyButton","resetZoomProxyGroup",e.langFormat("accessibility.resetZoomButton",{chart:e})),e.drillUpButton&&o(e.drillUpButton,"drillUpProxyButton","drillUpProxyGroup",e.langFormat("accessibility.drillUpButton",{chart:e,buttonText:e.getDrilldownBackText()}))},getMapZoomNavigation:function(){var t=this.keyCodes,e=this.chart,o=this;return new KeyboardNavigationHandler(e,{keyCodeMap:[[[t.up,t.down,t.left,t.right],function(o){return e[o===t.up||o===t.down?"yAxis":"xAxis"][0].panStep(o===t.left||o===t.up?-1:1),this.response.success}],[[t.tab],function(t,n){var a;return e.mapNavButtons[o.focusedMapNavButtonIx].setState(0),n.shiftKey&&!o.focusedMapNavButtonIx||!n.shiftKey&&o.focusedMapNavButtonIx?(e.mapZoom(),this.response[n.shiftKey?"prev":"next"]):(o.focusedMapNavButtonIx+=n.shiftKey?-1:1,a=e.mapNavButtons[o.focusedMapNavButtonIx],e.setFocusToElement(a.box,a.element),a.setState(2),this.response.success)}],[[t.space,t.enter],function(){return o.fakeClickEvent(e.mapNavButtons[o.focusedMapNavButtonIx].element),this.response.success}]],validate:function(){return e.mapZoom&&e.mapNavButtons&&2===e.mapNavButtons.length},init:function(t){var n=e.mapNavButtons[0],a=e.mapNavButtons[1],i=t>0?n:a;e.setFocusToElement(i.box,i.element),i.setState(2),o.focusedMapNavButtonIx=t>0?0:1}})},simpleButtonNavigation:function(t,e,o){var n=this.keyCodes,a=this,i=this.chart;return new KeyboardNavigationHandler(i,{keyCodeMap:[[[n.tab,n.up,n.down,n.left,n.right],function(t,e){return this.response[t===this.tab&&e.shiftKey||t===n.left||t===n.up?"prev":"next"]}],[[n.space,n.enter],function(){return o(i),this.response.success}]],validate:function(){return i[t]&&i[t].box&&a[e]},init:function(){i.setFocusToElement(i[t].box,a[e])}})},getKeyboardNavigation:function(){return[this.simpleButtonNavigation("resetZoomButton","resetZoomProxyButton",function(t){t.zoomOut()}),this.simpleButtonNavigation("drillUpButton","drillUpProxyButton",function(t){t.drillUp()}),this.getMapZoomNavigation()]}});export default ZoomComponent;