"use strict";import Highcharts from"../parts/Globals.js";import U from"../parts/Utilities.js";var pick=U.pick;import"../parts/Options.js";import"../parts/Series.js";var seriesType=Highcharts.seriesType,seriesTypes=Highcharts.seriesTypes,fireEvent=Highcharts.fireEvent,noop=Highcharts.noop;seriesType("funnel","pie",{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,size:!0,dataLabels:{connectorWidth:1},states:{select:{color:"#cccccc",borderColor:"#000000"}}},{animate:noop,translate:function(){var t,e,i,a,s,o,n,r,h,l,c=0,p=this,d=p.chart,g=p.options,b=g.reversed,f=g.ignoreHiddenPoint,u=d.plotWidth,m=d.plotHeight,y=0,W=g.center,v=w(W[0],u),x=w(W[1],m),A=w(g.width,u),L=w(g.height,m),k=w(g.neckWidth,u),D=w(g.neckHeight,m),H=x-L/2+L-D,T=p.data,Y="left"===g.dataLabels.position?1:0;function w(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)}p.getWidthAt=function(t){return t>H||L===D?k:k+(A-k)*(1-(t-(x-L/2))/(L-D))},p.getX=function(t,e,i){return v+(e?-1:1)*(p.getWidthAt(b?2*x-t:t)/2+i.labelDistance)},p.center=[v,x,L],p.centerX=v,T.forEach(function(t){f&&!1===t.visible||(c+=t.y)}),T.forEach(function(d){l=null,i=c?d.y/c:0,r=(s=x-L/2+y*L)+i*L,t=p.getWidthAt(s),o=(a=v-t/2)+t,t=p.getWidthAt(r),h=(n=v-t/2)+t,s>H?(a=n=v-k/2,o=h=v+k/2):r>H&&(l=r,t=p.getWidthAt(H),h=(n=v-t/2)+t,r=H),b&&(s=2*x-s,r=2*x-r,null!==l&&(l=2*x-l)),e=["M",a,s,"L",o,s,h,r],null!==l&&e.push(h,l,n,l),e.push(n,r,"Z"),d.shapeType="path",d.shapeArgs={d:e},d.percentage=100*i,d.plotX=v,d.plotY=(s+(l||r))/2,d.tooltipPos=[v,d.plotY],d.dlBox={x:n,y:s,topWidth:o-a,bottomWidth:h-n,height:Math.abs(pick(r,l)-s),width:NaN},d.slice=noop,d.half=Y,f&&!1===d.visible||(y+=i)}),fireEvent(p,"afterTranslate")},sortByAngle:function(t){t.sort(function(t,e){return t.plotY-e.plotY})},drawDataLabels:function(){var t,e,i,a,s,o=this.data,n=this.options.dataLabels.distance,r=o.length;for(this.center[2]-=2*n;r--;)e=(t=(i=o[r]).half)?1:-1,s=i.plotY,i.labelDistance=pick(i.options.dataLabels&&i.options.dataLabels.distance,n),this.maxLabelDistance=Math.max(i.labelDistance,this.maxLabelDistance||0),a=this.getX(s,t,i),i.labelPosition={natural:{x:0,y:s},final:{},alignment:t?"right":"left",connectorPosition:{breakAt:{x:a+(i.labelDistance-5)*e,y:s},touchingSliceAt:{x:a+i.labelDistance*e,y:s}}};seriesTypes[this.options.dataLabels.inside?"column":"pie"].prototype.drawDataLabels.call(this)},alignDataLabel:function(t,e,i,a,s){var o=t.series,n=o.options.reversed,r=t.dlBox||t.shapeArgs,h=i.align,l=i.verticalAlign,c=o.center[1],p=n?2*c-t.plotY:t.plotY,d=o.getWidthAt(p-r.height/2+e.height),g="middle"===l?(r.topWidth-r.bottomWidth)/4:(d-r.bottomWidth)/2,b=r.y,f=r.x;"middle"===l?b=r.y-r.height/2+e.height/2:"top"===l&&(b=r.y-r.height+e.height+i.padding),("top"===l&&!n||"bottom"===l&&n||"middle"===l)&&("right"===h?f=r.x-i.padding+g:"left"===h&&(f=r.x+i.padding-g)),a={x:f,y:n?b-r.height:b,width:r.bottomWidth,height:r.height},i.verticalAlign="bottom",Highcharts.Series.prototype.alignDataLabel.call(this,t,e,i,a,s),i.inside&&t.contrastColor&&e.css({color:t.contrastColor})}}),seriesType("pyramid","funnel",{neckWidth:"0%",neckHeight:"0%",reversed:!0});