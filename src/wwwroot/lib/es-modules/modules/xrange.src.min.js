"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var defined=U.defined,isNumber=U.isNumber,isObject=U.isObject,pick=U.pick,addEvent=H.addEvent,color=H.color,columnType=H.seriesTypes.column,correctFloat=H.correctFloat,merge=H.merge,seriesType=H.seriesType,seriesTypes=H.seriesTypes,Axis=H.Axis,Point=H.Point,Series=H.Series;function getColorByCategory(t,i){var o=t.options.colors||t.chart.options.colors,e=o?o.length:t.chart.options.chart.colorCount,r=i.y%e;return{colorIndex:r,color:o&&o[r]}}seriesType("xrange","column",{colorByPoint:!0,dataLabels:{formatter:function(){var t=this.point.partialFill;if(isObject(t)&&(t=t.amount),isNumber(t)&&t>0)return correctFloat(100*t)+"%"},inside:!0,verticalAlign:"middle"},tooltip:{headerFormat:'<span style="font-size: 10px">{point.x} - {point.x2}</span><br/>',pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.yCategory}</b><br/>'},borderRadius:3,pointRange:0},{type:"xrange",parallelArrays:["x","x2","y"],requireSorting:!1,animate:seriesTypes.line.prototype.animate,cropShoulder:1,getExtremesFromAll:!0,autoIncrement:H.noop,buildKDTree:H.noop,getColumnMetrics:function(){var t,i=this.chart;function o(){i.series.forEach(function(t){var i=t.xAxis;t.xAxis=t.yAxis,t.yAxis=i})}return o(),t=columnType.prototype.getColumnMetrics.call(this),o(),t},cropData:function(t,i,o,e){var r=Series.prototype.cropData.call(this,this.x2Data,i,o,e);return r.xData=t.slice(r.start,r.end),r},findPointIndex:function(t){var i,o,e=this.data,r=this.points,a=t.id;return a&&(i=H.find(e,function(t){return t.id===a}),o=i?i.index:void 0),void 0===o&&(i=H.find(e,function(i){return i.x===t.x&&i.x2===t.x2&&!(r[o]&&r[o].touched)}),o=i?i.index:void 0),this.cropped&&o>=this.cropStart&&(o-=this.cropStart),o},translatePoint:function(t){var i,o,e,r,a,s,n,l=this.xAxis,h=this.yAxis,p=this.columnMetrics,c=this.options,d=c.minPointLength||0,u=t.plotX,m=pick(t.x2,t.x+(t.len||0)),x=l.translate(m,0,0,0,1),g=Math.abs(x-u),y=this.chart.inverted,f=pick(c.borderWidth,1)%2/2,b=p.offset,M=Math.round(p.width);d&&((i=d-g)<0&&(i=0),u-=i/2,x+=i/2),u=Math.max(u,-10),x=Math.min(Math.max(x,-10),l.len+10),defined(t.options.pointWidth)&&(b-=(Math.ceil(t.options.pointWidth)-M)/2,M=Math.ceil(t.options.pointWidth)),c.pointPlacement&&isNumber(t.plotY)&&h.categories&&(t.plotY=h.translate(t.y,0,1,0,1,c.pointPlacement)),t.shapeArgs={x:Math.floor(Math.min(u,x))+f,y:Math.floor(t.plotY+b)+f,width:Math.round(Math.abs(x-u)),height:M,r:this.options.borderRadius},a=(r=t.shapeArgs.x)+t.shapeArgs.width,r<0||a>l.len?(r=Math.min(l.len,Math.max(0,r)),s=(a=Math.max(0,Math.min(a,l.len)))-r,t.dlBox=merge(t.shapeArgs,{x:r,width:a-r,centerX:s?s/2:null})):t.dlBox=null,y?(t.tooltipPos[1]+=g/2*(l.reversed?1:-1),t.tooltipPos[0]+=p.width/2,t.tooltipPos[1]=Math.max(Math.min(t.tooltipPos[1],l.len-1),0),t.tooltipPos[0]=Math.max(Math.min(t.tooltipPos[0],h.len-1),0)):(t.tooltipPos[0]+=g/2*(l.reversed?-1:1),t.tooltipPos[1]-=p.width/2,t.tooltipPos[0]=Math.max(Math.min(t.tooltipPos[0],l.len-1),0),t.tooltipPos[1]=Math.max(Math.min(t.tooltipPos[1],h.len-1),0)),(e=t.partialFill)&&(isObject(e)&&(e=e.amount),isNumber(e)||(e=0),o=t.shapeArgs,t.partShapeArgs={x:o.x,y:o.y,width:o.width,height:o.height,r:this.options.borderRadius},n=Math.max(Math.round(g*e+t.plotX-u),0),t.clipRectArgs={x:l.reversed?o.x+g-n:o.x,y:o.y,width:n,height:o.height})},translate:function(){columnType.prototype.translate.apply(this,arguments),this.points.forEach(function(t){this.translatePoint(t)},this)},drawPoint:function(t,i){var o,e=this.options,r=this.chart.renderer,a=t.graphic,s=t.shapeType,n=t.shapeArgs,l=t.partShapeArgs,h=t.clipRectArgs,p=t.partialFill,c=e.stacking&&!e.borderRadius,d=t.state,u=e.states[d||"normal"]||{},m=void 0===d?"attr":i,x=this.pointAttribs(t,d),g=pick(this.chart.options.chart.animation,u.animation);t.isNull?a&&(t.graphic=a.destroy()):(a?a.rect[i](n):(t.graphic=a=r.g("point").addClass(t.getClassName()).add(t.group||this.group),a.rect=r[s](merge(n)).addClass(t.getClassName()).addClass("highcharts-partfill-original").add(a)),l&&(a.partRect?(a.partRect[i](merge(l)),a.partialClipRect[i](merge(h))):(a.partialClipRect=r.clipRect(h.x,h.y,h.width,h.height),a.partRect=r[s](l).addClass("highcharts-partfill-overlay").add(a).clip(a.partialClipRect))),this.chart.styledMode||(a.rect[i](x,g).shadow(e.shadow,null,c),l&&(isObject(p)||(p={}),isObject(e.partialFill)&&(p=merge(p,e.partialFill)),o=p.fill||color(x.fill).brighten(-.3).get()||color(t.color||this.color).brighten(-.3).get(),x.fill=o,a.partRect[m](x,g).shadow(e.shadow,null,c))))},drawPoints:function(){var t=this,i=t.getAnimationVerb();t.points.forEach(function(o){t.drawPoint(o,i)})},getAnimationVerb:function(){return this.chart.pointCount<(this.options.animationLimit||250)?"animate":"attr"}},{resolveColor:function(){var t,i=this.series;i.options.colorByPoint&&!this.options.color?(t=getColorByCategory(i,this),i.chart.styledMode||(this.color=t.color),this.options.colorIndex||(this.colorIndex=t.colorIndex)):this.color||(this.color=i.color)},init:function(){return Point.prototype.init.apply(this,arguments),this.y||(this.y=0),this},setState:function(){Point.prototype.setState.apply(this,arguments),this.series.drawPoint(this,this.series.getAnimationVerb())},getLabelConfig:function(){var t=Point.prototype.getLabelConfig.call(this),i=this.series.yAxis.categories;return t.x2=this.x2,t.yCategory=this.yCategory=i&&i[this.y],t},tooltipDateKeys:["x","x2"],isValid:function(){return"number"==typeof this.x&&"number"==typeof this.x2}}),addEvent(Axis,"afterGetSeriesExtremes",function(){var t,i,o=this.series;this.isXAxis&&(t=pick(this.dataMax,-Number.MAX_VALUE),o.forEach(function(o){o.x2Data&&o.x2Data.forEach(function(o){o>t&&(t=o,i=!0)})}),i&&(this.dataMax=t))});