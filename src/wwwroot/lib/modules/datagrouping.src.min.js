"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/datagrouping",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function o(t,e,o,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,o))}o(e,"parts/DataGrouping.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(t,e){function o(t,e,o,a){var r,i,n,s,p,u,l,h=this,d=h.data,g=h.options&&h.options.data,c=[],f=[],m=[],y=t.length,D=!!e,G=[],x=h.pointArrayMap,v=x&&x.length,M=["x"].concat(x||["y"]),b=0,A=0;for(s="function"==typeof(l=a)?l:Y[l]?Y[l]:Y[h.getDGApproximation&&h.getDGApproximation()||"average"],v?x.forEach(function(){G.push([])}):G.push([]),p=v||1,u=0;u<=y&&!(t[u]>=o[0]);u++);for(;u<=y;u++){for(;void 0!==o[b+1]&&t[u]>=o[b+1]||u===y;){for(r=o[b],h.dataGroupInfo={start:h.cropStart+A,length:G[0].length},n=s.apply(h,G),h.pointClass&&!T(h.dataGroupInfo.options)&&(h.dataGroupInfo.options=F(h.pointClass.prototype.optionsToObject.call({series:h},h.options.data[h.cropStart+A])),M.forEach(function(t){delete h.dataGroupInfo.options[t]})),void 0!==n&&(c.push(r),f.push(n),m.push(h.dataGroupInfo)),A=u,k=0;k<p;k++)G[k].length=0,G[k].hasNulls=!1;if(b+=1,u===y)break}if(u===y)break;if(x)for(var S,P=h.cropStart+u,H=d&&d[P]||h.pointClass.prototype.applyOptions.apply({series:h},[g[P]]),k=0;k<v;k++)S=H[x[k]],W(S)?G[k].push(S):null===S&&(G[k].hasNulls=!0);else i=D?e[u]:null,W(i)?G[0].push(i):null===i&&(G[0].hasNulls=!0)}return{groupedXData:c,groupedYData:f,groupMap:m}}var a=e.arrayMax,r=e.arrayMin,T=e.defined,f=e.extend,W=e.isNumber,H=e.pick,i=t.addEvent,n=t.Axis,s=t.correctFloat,p=t.defaultPlotOptions,m=t.format,F=t.merge,u=t.Point,l=t.Series,h=t.Tooltip,Y=t.approximations={sum:function(t){var e,o=t.length;if(!o&&t.hasNulls)e=null;else if(o)for(e=0;o--;)e+=t[o];return e},average:function(t){var e=t.length,o=Y.sum(t);return W(o)&&e&&(o=s(o/e)),o},averages:function(){var e=[];return[].forEach.call(arguments,function(t){e.push(Y.average(t))}),void 0===e[0]?void 0:e},open:function(t){return t.length?t[0]:t.hasNulls?null:void 0},high:function(t){return t.length?a(t):t.hasNulls?null:void 0},low:function(t){return t.length?r(t):t.hasNulls?null:void 0},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:void 0},ohlc:function(t,e,o,a){if(t=Y.open(t),e=Y.high(e),o=Y.low(o),a=Y.close(a),W(t)||W(e)||W(o)||W(a))return[t,e,o,a]},range:function(t,e){return t=Y.low(t),e=Y.high(e),W(t)||W(e)?[t,e]:null===t&&null===e?null:void 0}},d={approximations:Y,groupData:o},k=l.prototype,N=k.processData,g=k.generatePoints,y={groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},c={line:{},spline:{},area:{},areaspline:{},arearange:{},column:{groupPixelWidth:10},columnrange:{groupPixelWidth:10},candlestick:{groupPixelWidth:10},ohlc:{groupPixelWidth:5}},O=t.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]];return k.getDGApproximation=function(){return t.seriesTypes.arearange&&this instanceof t.seriesTypes.arearange?"range":t.seriesTypes.ohlc&&this instanceof t.seriesTypes.ohlc?"ohlc":t.seriesTypes.column&&this instanceof t.seriesTypes.column?"sum":"average"},k.groupData=o,k.processData=function(){var t,e,o,a,r=this,i=r.chart,n=r.options.dataGrouping,s=!1!==r.allowDG&&n&&H(n.enabled,i.options.isStock),p=r.visible||!i.options.chart.ignoreHiddenSeries,u=this.currentDataGrouping,l=!1;if(r.forceCrop=s,r.groupPixelWidth=null,r.hasProcessed=!0,s&&!r.requireSorting&&(r.requireSorting=l=!0),e=!1===N.apply(r,arguments)||!s,l&&(r.requireSorting=!1),!e){r.destroyGroupedData();var h,d=n.groupAll?r.xData:r.processedXData,g=n.groupAll?r.yData:r.processedYData,c=i.plotSizeX,f=r.xAxis,m=f.options.ordinal,y=r.groupPixelWidth=f.getGroupPixelWidth&&f.getGroupPixelWidth();if(y){t=!0,r.isDirty=!0,r.points=null;var D=f.getExtremes(),G=D.min,x=D.max,v=y*(x-G)/c*(m&&f.getGroupIntervalFactor(G,x,r)||1),M=f.getTimeTicks(f.normalizeTimeTickInterval(v,n.units||O),Math.min(G,d[0]),Math.max(x,d[d.length-1]),f.options.startOfWeek,d,r.closestPointRange),b=k.groupData.apply(r,[d,g,M,n.approximation]),A=b.groupedXData,S=b.groupedYData,P=0;if(n.smoothed&&A.length){for(A[h=A.length-1]=Math.min(A[h],x);h--&&0<h;)A[h]+=v/2;A[0]=Math.max(A[0],G)}for(h=1;h<M.length;h++)M.info.segmentStarts&&-1!==M.info.segmentStarts.indexOf(h)||(P=Math.max(M[h]-M[h-1],P));(o=M.info).gapSize=P,r.closestPointRange=M.info.totalRange,r.groupMap=b.groupMap,T(A[0])&&A[0]<f.min&&p&&((!T(f.options.min)&&f.min<=f.dataMin||f.min===f.dataMin)&&(f.min=Math.min(A[0],f.min)),f.dataMin=A[0]),n.groupAll&&(A=(a=r.cropData(A,S,f.min,f.max,1)).xData,S=a.yData),r.processedXData=A,r.processedYData=S}else r.groupMap=null;r.hasGroupedData=t,r.currentDataGrouping=o,r.preventGraphAnimation=(u&&u.totalRange)!==(o&&o.totalRange)}},k.destroyGroupedData=function(){this.groupedData&&(this.groupedData.forEach(function(t,e){t&&(this.groupedData[e]=t.destroy?t.destroy():null)},this),this.groupedData.length=0)},k.generatePoints=function(){g.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},i(u,"update",function(){if(this.dataGroup)return t.error(24,!1,this.series.chart),!1}),i(h,"headerFormatter",function(t){var e,o,a,r,i,n=this.chart.time,s=t.labelConfig,p=s.series,u=p.options,l=p.tooltipOptions,h=u.dataGrouping,d=l.xDateFormat,g=p.xAxis,c=l[(t.isFooter?"footer":"header")+"Format"];g&&"datetime"===g.options.type&&h&&W(s.key)&&(o=p.currentDataGrouping,a=h.dateTimeLabelFormats||y.dateTimeLabelFormats,o?(r=a[o.unitName],1===o.count?d=r[0]:(d=r[1],e=r[2])):!d&&a&&(d=this.getXDateFormat(s,l,g)),i=n.dateFormat(d,s.key),e&&(i+=n.dateFormat(e,s.key+o.totalRange-1)),p.chart.styledMode&&(c=this.styledModeFormat(c)),t.text=m(c,{point:f(s.point,{key:i}),series:p},n),t.preventDefault())}),i(l,"destroy",k.destroyGroupedData),i(l,"afterSetOptions",function(t){var e=t.options,o=this.type,a=this.chart.options.plotOptions,r=p[o].dataGrouping,i=this.useCommonDataGrouping&&y;(c[o]||i)&&(r=r||F(y,c[o]),e.dataGrouping=F(i,r,a.series&&a.series.dataGrouping,a[o].dataGrouping,this.userOptions.dataGrouping))}),i(n,"afterSetScale",function(){this.series.forEach(function(t){t.hasProcessed=!1})}),n.prototype.getGroupPixelWidth=function(){for(var t,e,o=this.series,a=o.length,r=0,i=!1,n=a;n--;)(e=o[n].options.dataGrouping)&&(r=Math.max(r,H(e.groupPixelWidth,y.groupPixelWidth)));for(n=a;n--;)(e=o[n].options.dataGrouping)&&o[n].hasProcessed&&(t=(o[n].processedXData||o[n].data).length,(o[n].groupPixelWidth||t>this.chart.plotSizeX/r||t&&e.forced)&&(i=!0));return i?r:0},n.prototype.setDataGrouping=function(e,t){var o;if(t=H(t,!0),e=e||{forced:!1,units:null},this instanceof n)for(o=this.series.length;o--;)this.series[o].update({dataGrouping:e},!1);else this.chart.options.series.forEach(function(t){t.dataGrouping=e},!1);this.ordinalSlope=null,t&&this.chart.redraw()},t.dataGrouping=d}),o(e,"masters/modules/datagrouping.src.js",[e["parts/DataGrouping.js"]],function(t){return t})});