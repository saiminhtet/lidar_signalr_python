"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function o(t,e,o,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,o))}o(e,"mixins/ajax.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(r,t){var i=t.objectEach;r.ajax=function(t){var o=r.merge(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},t),e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},a=new XMLHttpRequest;function n(t,e){o.error&&o.error(t,e)}if(!o.url)return!1;a.open(o.type.toUpperCase(),o.url,!0),o.headers["Content-Type"]||a.setRequestHeader("Content-Type",e[o.dataType]||e.text),i(o.headers,function(t,e){a.setRequestHeader(e,t)}),a.onreadystatechange=function(){var t;if(4===a.readyState){if(200===a.status){if(t=a.responseText,"json"===o.dataType)try{t=JSON.parse(t)}catch(t){return n(a,t)}return o.success&&o.success(t)}n(a,a.responseText)}};try{o.data=JSON.stringify(o.data)}catch(t){}a.send(o.data||!0)},r.getJSON=function(t,e){r.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),o(e,"mixins/download-url.js",[e["parts/Globals.js"]],function(a){var s=a.win,n=s.navigator,r=s.document,l=s.URL||s.webkitURL||s,i=/Edge\/\d+/.test(n.userAgent);a.dataURLtoBlob=function(t){var e=t.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(e&&3<e.length&&s.atob&&s.ArrayBuffer&&s.Uint8Array&&s.Blob&&l.createObjectURL){for(var o,a=s.atob(e[3]),n=new s.ArrayBuffer(a.length),r=new s.Uint8Array(n),i=0;i<r.length;++i)r[i]=a.charCodeAt(i);return o=new s.Blob([r],{type:e[1]}),l.createObjectURL(o)}},a.downloadURL=function(e,t){var o=r.createElement("a");if("string"==typeof e||e instanceof String||!n.msSaveOrOpenBlob){if((i||2e6<e.length)&&!(e=a.dataURLtoBlob(e)))throw new Error("Failed to convert to blob");if(void 0!==o.download)o.href=e,o.download=t,r.body.appendChild(o),o.click(),r.body.removeChild(o);else try{if(null==s.open(e,"chart"))throw new Error("Failed to open window")}catch(t){s.location.href=e}}else n.msSaveOrOpenBlob(e,t)}}),o(e,"modules/export-data.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(D,t){var p=t.defined,e=t.extend,a=t.isObject,A=t.pick,i=D.win,n=i.document,o=D.seriesTypes,r=D.downloadURL,u=D.fireEvent;function s(t,e){var o=i.navigator,a=-1<o.userAgent.indexOf("WebKit")&&o.userAgent.indexOf("Chrome")<0,n=i.URL||i.webkitURL||i;try{if(o.msSaveOrOpenBlob&&i.MSBlobBuilder){var r=new i.MSBlobBuilder;return r.append(t),r.getBlob("image/svg+xml")}if(!a)return n.createObjectURL(new i.Blob(["\ufeff"+t],{type:e}))}catch(t){}}D.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}}),D.addEvent(D.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),D.Chart.prototype.setUpKeyToAxis=function(){o.arearange&&(o.arearange.prototype.keyToAxis={low:"y",high:"y"}),o.gantt&&(o.gantt.prototype.keyToAxis={start:"x",end:"x"})},D.Chart.prototype.getDataRows=function(n){function t(t,e,o){if(y.columnHeaderFormatter){var a=y.columnHeaderFormatter(t,e,o);if(!1!==a)return a}return t?t instanceof D.Axis?t.options.title&&t.options.title.text||(t.isDatetimeAxis?"DateTime":"Category"):n?{columnTitle:1<o?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<o?" ("+e+")":""):"Category"}function m(a,t,n){var r={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",o=D.isNumber(n)?a.chart[e][n]:a[e];r[t]=o&&o.categories||[],i[t]=o&&o.isDatetimeAxis}),{categoryMap:r,dateTimeValueAxisMap:i}}var o,e,a,r,i,s,l,x=this.hasParallelCoordinates,g=this.time,y=this.options.exporting&&this.options.exporting.csv||{},b=this.xAxis,v={},c=[],w=[],C=[],T=[],S=0;for(r in this.setUpKeyToAxis(),this.series.forEach(function(s){var l,c,p=s.options.keys||s.pointArrayMap||["y"],d=p.length,h=!s.requireSorting&&{},u=b.indexOf(s.xAxis),f=m(s,p);if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(D.find(T,function(t){return t[0]===u})||T.push([u,S]),c=0;c<d;)a=t(s,p[c],p.length),C.push(a.columnTitle||a),n&&w.push(a.topLevelColumnTitle||a),c++;l={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap},s.options.data.forEach(function(t,e){var o,a,n,r,i;for(x&&(f=m(s,p,e)),i={series:l},s.pointClass.prototype.applyOptions.apply(i,[t]),o=i.x,r=s.data[e]&&s.data[e].name,c=0,s.xAxis&&"name"!==s.exportKey||(o=r),h&&(h[o]&&(o+="|"+e),h[o]=!0),v[o]||(v[o]=[],v[o].xValues=[]),v[o].x=i.x,v[o].name=r,v[o].xValues[u]=i.x;c<d;)n=i[a=p[c]],v[o][S+c]=A(f.categoryMap[a][n],f.dateTimeValueAxisMap[a]?g.dateFormat(y.dateFormat,n):null,n),c++}),S+=c}}),v)Object.hasOwnProperty.call(v,r)&&c.push(v[r]);for(e=n?[w,C]:[C],S=T.length;S--;)s=T[S][0],l=T[S][1],o=b[s],c.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),i=t(o),e[0].splice(l,0,i),n&&e[1]&&e[1].splice(l,0,i),c.forEach(function(t){var e=t.name;o&&!p(e)&&(e=o.isDatetimeAxis?(t.x instanceof Date&&(t.x=t.x.getTime()),g.dateFormat(y.dateFormat,t.x)):o.categories?A(o.names[t.x],o.categories[t.x],t.x):t.x),t.splice(l,0,e)});return e=e.concat(c),u(this,"exportData",{dataRows:e}),e},D.Chart.prototype.getCSV=function(t){var n="",r=this.getDataRows(),e=this.options.exporting.csv,i=A(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=A(e.itemDelimiter,","===i?";":","),l=e.lineDelimiter;return r.forEach(function(t,e){for(var o="",a=t.length;a--;)"string"==typeof(o=t[a])&&(o='"'+o+'"'),"number"==typeof o&&"."!==i&&(o=o.toString().replace(".",i)),t[a]=o;n+=t.join(s),e<r.length-1&&(n+=l)}),n},D.Chart.prototype.getTable=function(t){function c(t,e,o,a){var n=A(a,""),r="text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===i&&(n=n.replace(".",i)),r="number"):a||(r="empty"),"<"+t+(o?" "+o:"")+' class="'+r+'">'+n+"</"+t+">"}var o='<table id="highcharts-data-table-'+this.index+'">',p=this.options,i=t?1.1.toLocaleString()[1]:".",d=A(p.exporting.useMultiLevelHeaders,!0),e=this.getDataRows(d),a=0,n=d?e.shift():null,r=e.shift();!1!==p.exporting.tableCaption&&(o+='<caption class="highcharts-table-caption">'+A(p.exporting.tableCaption,p.title.text?p.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var s=0,l=e.length;s<l;++s)e[s].length>a&&(a=e[s].length);o+=function(t,e,o){var a,n,r="<thead>",i=0,s=o||e&&e.length,l=0;if(d&&t&&e&&!function(t,e){var o=t.length;if(e.length!==o)return!1;for(;o--;)if(t[o]!==e[o])return!1;return!0}(t,e)){for(r+="<tr>";i<s;++i)(a=t[i])===t[i+1]?++l:l?(r+=c("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',a),l=0):(a===e[i]?p.exporting.useRowspanHeaders?(n=2,delete e[i]):(n=1,e[i]=""):n=1,r+=c("th","highcharts-table-topheading",'scope="col"'+(1<n?' valign="top" rowspan="'+n+'"':""),a));r+="</tr>"}if(e){for(r+="<tr>",i=0,s=e.length;i<s;++i)void 0!==e[i]&&(r+=c("th",null,'scope="col"',e[i]));r+="</tr>"}return r+="</thead>"}(n,r,Math.max(a,r.length)),o+="<tbody>",e.forEach(function(t){o+="<tr>";for(var e=0;e<a;e++)o+=c(e?"td":"th",null,e?"":'scope="row"',t[e]);o+="</tr>"});var h={html:o+="</tbody></table>"};return u(this,"afterGetTable",h),h.html},D.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);r(s(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},D.Chart.prototype.downloadXLS=function(){var t,e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";r(s(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+(t=e,i.btoa(unescape(encodeURIComponent(t)))),this.getFilename()+".xls")},D.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=n.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),u(this,"afterViewData",this.dataTableDiv)},D.Chart.prototype.openInCloud=function(){var t,e,o;(function e(o){Object.keys(o).forEach(function(t){"function"==typeof o[t]&&delete o[t],a(o[t])&&e(o[t])})})(t=D.merge(this.userOptions)),e={name:t.title&&t.title.text||"Chart title",options:t,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}},o=JSON.stringify(e),function(){var t=n.createElement("form");n.body.appendChild(t),t.method="post",t.action="https://cloud-api.highcharts.com/openincloud",t.target="_blank";var e=n.createElement("input");e.type="hidden",e.name="chart",e.value=o,t.appendChild(e),t.submit(),n.body.removeChild(t)}()};var l=D.getOptions().exporting;l&&(e(l.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}}),l.buttons&&l.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud")),o.map&&(o.map.prototype.exportKey="name"),o.mapbubble&&(o.mapbubble.prototype.exportKey="name"),o.treemap&&(o.treemap.prototype.exportKey="name")}),o(e,"masters/modules/export-data.src.js",[],function(){})});