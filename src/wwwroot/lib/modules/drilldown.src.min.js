"use strict";!function(i){"object"==typeof module&&module.exports?module.exports=i.default=i:"function"==typeof define&&define.amd?define("highcharts/modules/drilldown",["highcharts"],function(t){return i(t),i.Highcharts=t,i}):i("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var i=t?t._modules:{};function e(t,i,e,o){t.hasOwnProperty(i)||(t[i]=o.apply(null,e))}e(i,"modules/drilldown.src.js",[i["parts/Globals.js"],i["parts/Utilities.js"]],function(u,t){var f=t.extend,o=t.objectEach,m=t.pick,e=t.syncTimeout,d=u.animObject,v=u.noop,g=u.color,i=u.defaultOptions,r=u.format,s=u.Chart,n=u.seriesTypes,l=n.pie,a=n.column,p=u.Tick,h=u.fireEvent,w=1;f(i.lang,{drillUpText:"‚óÅ Back to {series.name}"}),i.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},activeDataLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}},u.SVGRenderer.prototype.Element.prototype.fadeIn=function(t){this.attr({opacity:.1,visibility:"inherit"}).animate({opacity:m(this.newOpacity,1)},t||{duration:250})},s.prototype.addSeriesAsDrilldown=function(t,i){this.addSingleSeriesAsDrilldown(t,i),this.applyDrilldown()},s.prototype.addSingleSeriesAsDrilldown=function(t,i){var e,o,r,s,n,l=t.series,a=l.xAxis,d=l.yAxis,p=[],h=[],c=this.styledMode?{colorIndex:m(t.colorIndex,l.colorIndex)}:{color:t.color||l.color};this.drilldownLevels||(this.drilldownLevels=[]),s=l.options._levelNumber||0,(n=this.drilldownLevels[this.drilldownLevels.length-1])&&n.levelNumber!==s&&(n=void 0),i=f(f({_ddSeriesId:w++},c),i),o=l.points.indexOf(t),l.chart.series.forEach(function(t){t.xAxis!==a||t.isDrilling||(t.options._ddSeriesId=t.options._ddSeriesId||w++,t.options._colorIndex=t.userOptions._colorIndex,t.options._levelNumber=t.options._levelNumber||s,n?(p=n.levelSeries,h=n.levelSeriesOptions):(p.push(t),t.purgedOptions=u.merge({_ddSeriesId:t.options._ddSeriesId,_levelNumber:t.options._levelNumber,selected:t.options.selected},t.userOptions),h.push(t.purgedOptions)))}),r=f({levelNumber:s,seriesOptions:l.options,seriesPurgedOptions:l.purgedOptions,levelSeriesOptions:h,levelSeries:p,shapeArgs:t.shapeArgs,bBox:t.graphic?t.graphic.getBBox():{},color:t.isNull?new u.Color(g).setOpacity(0).get():g,lowerSeriesOptions:i,pointOptions:l.options.data[o],pointIndex:o,oldExtremes:{xMin:a&&a.userMin,xMax:a&&a.userMax,yMin:d&&d.userMin,yMax:d&&d.userMax},resetZoomButton:this.resetZoomButton},c),this.drilldownLevels.push(r),a&&a.names&&(a.names.length=0),(e=r.lowerSeries=this.addSeries(i,!1)).options._levelNumber=s+1,a&&(a.oldPos=a.pos,a.userMin=a.userMax=null,d.userMin=d.userMax=null),l.type===e.type&&(e.animate=e.animateDrilldown||v,e.options.animation=!0)},s.prototype.applyDrilldown=function(){var i,t=this.drilldownLevels;t&&0<t.length&&(i=t[t.length-1].levelNumber,this.drilldownLevels.forEach(function(t){t.levelNumber===i&&t.levelSeries.forEach(function(t){t.options&&t.options._levelNumber===i&&t.remove(!1)})})),this.resetZoomButton&&(this.resetZoomButton.hide(),delete this.resetZoomButton),this.pointer.reset(),this.redraw(),this.showDrillUpButton(),h(this,"afterDrilldown")},s.prototype.getDrilldownBackText=function(){var t,i=this.drilldownLevels;if(i&&0<i.length)return(t=i[i.length-1]).series=t.seriesOptions,r(this.options.lang.drillUpText,t)},s.prototype.showDrillUpButton=function(){var t,i,e=this,o=this.getDrilldownBackText(),r=e.options.drilldown.drillUpButton;this.drillUpButton?this.drillUpButton.attr({text:o}).align():(i=(t=r.theme)&&t.states,this.drillUpButton=this.renderer.button(o,null,null,function(){e.drillUp()},t,i&&i.hover,i&&i.select).addClass("highcharts-drillup-button").attr({align:r.position.align,zIndex:7}).add().align(r.position,!1,r.relativeTo||"plotBox"))},s.prototype.drillUp=function(){if(this.drilldownLevels&&0!==this.drilldownLevels.length){for(var t,o,r,s,i,n=this,e=n.drilldownLevels,l=e[e.length-1].levelNumber,a=e.length,d=n.series,p=function(i){var e;d.forEach(function(t){t.options._ddSeriesId===i._ddSeriesId&&(e=t)}),(e=e||n.addSeries(i,!1)).type===r.type&&e.animateDrillupTo&&(e.animate=e.animateDrillupTo),i===o.seriesPurgedOptions&&(s=e)};a--;)if((o=e[a]).levelNumber===l){if(e.pop(),!(r=o.lowerSeries).chart)for(t=d.length;t--;)if(d[t].options.id===o.lowerSeriesOptions.id&&d[t].options._levelNumber===l+1){r=d[t];break}r.xData=[],o.levelSeriesOptions.forEach(p),h(n,"drillup",{seriesOptions:o.seriesOptions}),s.type===r.type&&(s.drilldownLevel=o,s.options.animation=n.options.drilldown.animation,r.animateDrillupFrom&&r.chart&&r.animateDrillupFrom(o)),s.options._levelNumber=l,r.remove(!1),s.xAxis&&(i=o.oldExtremes,s.xAxis.setExtremes(i.xMin,i.xMax,!1),s.yAxis.setExtremes(i.yMin,i.yMax,!1)),o.resetZoomButton&&(n.resetZoomButton=o.resetZoomButton,n.resetZoomButton.show())}this.redraw(),0===this.drilldownLevels.length?this.drillUpButton=this.drillUpButton.destroy():this.drillUpButton.attr({text:this.getDrilldownBackText()}).align(),this.ddDupes.length=[],h(n,"drillupall")}},s.prototype.callbacks.push(function(){var e=this;e.drilldown={update:function(t,i){u.merge(!0,e.options.drilldown,t),m(i,!0)&&e.redraw()}}}),u.addEvent(s,"beforeShowResetZoom",function(){if(this.drillUpButton)return!1}),u.addEvent(s,"render",function(){(this.xAxis||[]).forEach(function(s){s.ddPoints={},s.series.forEach(function(t){for(var i,e=t.xData||[],o=t.points,r=0;r<e.length;r++)"number"!=typeof(i=t.options.data[r])&&(i=t.pointClass.prototype.optionsToObject.call({series:t},i)).drilldown&&(s.ddPoints[e[r]]||(s.ddPoints[e[r]]=[]),s.ddPoints[e[r]].push(!o||o[r]))}),o(s.ticks,p.prototype.drillable)})}),a.prototype.animateDrillupTo=function(t){var i,s;t||(s=(i=this).drilldownLevel,this.points.forEach(function(t){var i=t.dataLabel;t.graphic&&t.graphic.hide(),i&&(i.hidden="hidden"===i.attr("visibility"),i.hidden||(i.hide(),t.connector&&t.connector.hide()))}),e(function(){i.points&&i.points.forEach(function(t,i){var e=i===(s&&s.pointIndex)?"show":"fadeIn",o="show"==e||void 0,r=t.dataLabel;t.graphic&&t.graphic[e](o),r&&!r.hidden&&(r.fadeIn(),t.connector&&t.connector.fadeIn())})},Math.max(this.chart.options.drilldown.animation.duration-50,0)),this.animate=v)},a.prototype.animateDrilldown=function(t){var e,o=this,i=this.chart,r=i.drilldownLevels,s=d(i.options.drilldown.animation),n=this.xAxis,l=i.styledMode;t||(r.forEach(function(t){o.options._ddSeriesId===t.lowerSeriesOptions._ddSeriesId&&(e=t.shapeArgs,l||(e.fill=t.color))}),e.x+=m(n.oldPos,n.pos)-n.pos,this.points.forEach(function(t){var i=t.shapeArgs;l||(i.fill=t.color),t.graphic&&t.graphic.attr(e).animate(f(t.shapeArgs,{fill:t.color||o.color}),s),t.dataLabel&&t.dataLabel.fadeIn(s)}),this.animate=null)},a.prototype.animateDrillupFrom=function(r){var s=d(this.chart.options.drilldown.animation),n=this.group,l=n!==this.chart.columnGroup,a=this;a.trackerGroups.forEach(function(t){a[t]&&a[t].on("mouseover")}),l&&delete this.group,this.points.forEach(function(t){function i(){e.destroy(),n&&l&&(n=n.destroy())}var e=t.graphic,o=r.shapeArgs;e&&(delete t.graphic,a.chart.styledMode||(o.fill=r.color),s.duration?e.animate(o,u.merge(s,{complete:i})):(e.attr(o),i()))})},l&&f(l.prototype,{animateDrillupTo:a.prototype.animateDrillupTo,animateDrillupFrom:a.prototype.animateDrillupFrom,animateDrilldown:function(t){var o=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],r=this.chart.options.drilldown.animation,s=o.shapeArgs,n=s.start,l=(s.end-n)/this.points.length,a=this.chart.styledMode;t||(this.points.forEach(function(t,i){var e=t.shapeArgs;a||(s.fill=o.color,e.fill=t.color),t.graphic&&t.graphic.attr(u.merge(s,{start:n+i*l,end:n+(i+1)*l}))[r?"animate":"attr"](e,r)}),this.animate=null)}}),u.Point.prototype.doDrilldown=function(o,t,i){var e,r=this.series.chart,s=r.options.drilldown,n=(s.series||[]).length;for(r.ddDupes||(r.ddDupes=[]);n--&&!e;)s.series[n].id===this.drilldown&&-1===r.ddDupes.indexOf(this.drilldown)&&(e=s.series[n],r.ddDupes.push(this.drilldown));h(r,"drilldown",{point:this,seriesOptions:e,category:t,originalEvent:i,points:void 0!==t&&this.series.xAxis.getDDPoints(t).slice(0)},function(t){var i=t.point.series&&t.point.series.chart,e=t.seriesOptions;i&&e&&(o?i.addSingleSeriesAsDrilldown(t.point,e):i.addSeriesAsDrilldown(t.point,e))})},u.Axis.prototype.drilldownCategory=function(i,e){o(this.getDDPoints(i),function(t){t&&t.series&&t.series.visible&&t.doDrilldown&&t.doDrilldown(!0,i,e)}),this.chart.applyDrilldown()},u.Axis.prototype.getDDPoints=function(t){return this.ddPoints&&this.ddPoints[t]},p.prototype.drillable=function(){var i=this.pos,t=this.label,e=this.axis,o="xAxis"===e.coll&&e.getDDPoints,r=o&&e.getDDPoints(i),s=e.chart.styledMode;o&&(t&&r&&r.length?(t.drillable=!0,t.basicStyles||s||(t.basicStyles=u.merge(t.styles)),t.addClass("highcharts-drilldown-axis-label").on("click",function(t){e.drilldownCategory(i,t)}),s||t.css(e.chart.options.drilldown.activeAxisLabelStyle)):t&&t.drillable&&(s||(t.styles={},t.css(t.basicStyles)),t.on("click",null),t.removeClass("highcharts-drilldown-axis-label")))},u.addEvent(u.Point,"afterInit",function(){var i=this,e=i.series;return i.drilldown&&u.addEvent(i,"click",function(t){e.xAxis&&!1===e.chart.options.drilldown.allowPointDrilldown?e.xAxis.drilldownCategory(i.x,t):i.doDrilldown(void 0,void 0,t)}),i}),u.addEvent(u.Series,"afterDrawDataLabels",function(){var o=this.chart.options.drilldown.activeDataLabelStyle,r=this.chart.renderer,s=this.chart.styledMode;this.points.forEach(function(t){var i=t.options.dataLabels,e=m(t.dlOptions,i&&i.style,{});t.drilldown&&t.dataLabel&&("contrast"!==o.color||s||(e.color=r.getContrast(t.color||this.color)),i&&i.color&&(e.color=i.color),t.dataLabel.addClass("highcharts-drilldown-data-label"),s||t.dataLabel.css(o).css(e))},this)});function c(t,i,e,o){t[e?"addClass":"removeClass"]("highcharts-drilldown-point"),o||t.css({cursor:i})}u.addEvent(u.Series,"afterDrawTracker",function(){var i=this.chart.styledMode;this.points.forEach(function(t){t.drilldown&&t.graphic&&c(t.graphic,"pointer",!0,i)})}),u.addEvent(u.Point,"afterSetState",function(){var t=this.series.chart.styledMode;this.drilldown&&this.series.halo&&"hover"===this.state?c(this.series.halo,"pointer",!0,t):this.series.halo&&c(this.series.halo,"auto",!1,t)})}),e(i,"masters/modules/drilldown.src.js",[],function(){})});