!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,o))}e(t=t?t._modules:{},"mixins/ajax.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(a,t){var n=t.objectEach;a.ajax=function(t){var e=a.merge(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},t);t={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var o=new XMLHttpRequest;if(!e.url)return!1;o.open(e.type.toUpperCase(),e.url,!0),e.headers["Content-Type"]||o.setRequestHeader("Content-Type",t[e.dataType]||t.text),n(e.headers,function(t,e){o.setRequestHeader(e,t)}),o.onreadystatechange=function(){if(4===o.readyState){if(200===o.status){var t=o.responseText;if("json"===e.dataType)try{t=JSON.parse(t)}catch(t){return void(e.error&&e.error(o,t))}return e.success&&e.success(t)}e.error&&e.error(o,o.responseText)}};try{e.data=JSON.stringify(e.data)}catch(t){}o.send(e.data||!0)},a.getJSON=function(t,e){a.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),e(t,"mixins/download-url.js",[t["parts/Globals.js"]],function(n){var r=n.win,i=r.navigator,s=r.document,l=r.URL||r.webkitURL||r,c=/Edge\/\d+/.test(i.userAgent);n.dataURLtoBlob=function(t){if((t=t.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&l.createObjectURL){for(var e=r.atob(t[3]),o=new r.ArrayBuffer(e.length),o=new r.Uint8Array(o),a=0;a<o.length;++a)o[a]=e.charCodeAt(a);return t=new r.Blob([o],{type:t[1]}),l.createObjectURL(t)}},n.downloadURL=function(e,t){var o=s.createElement("a");if("string"==typeof e||e instanceof String||!i.msSaveOrOpenBlob){if((c||2e6<e.length)&&!(e=n.dataURLtoBlob(e)))throw Error("Failed to convert to blob");if(void 0!==o.download)o.href=e,o.download=t,s.body.appendChild(o),o.click(),s.body.removeChild(o);else try{var a=r.open(e,"chart");if(null==a)throw Error("Failed to open window")}catch(t){r.location.href=e}}else i.msSaveOrOpenBlob(e,t)}}),e(t,"modules/export-data.src.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(C,t){function e(t,e){var o=i.navigator,a=-1<o.userAgent.indexOf("WebKit")&&o.userAgent.indexOf("Chrome")<0,n=i.URL||i.webkitURL||i;try{if(o.msSaveOrOpenBlob&&i.MSBlobBuilder){var r=new i.MSBlobBuilder;return r.append(t),r.getBlob("image/svg+xml")}if(!a)return n.createObjectURL(new i.Blob(["\ufeff"+t],{type:e}))}catch(t){}}var c=t.defined,o=t.extend,a=t.isObject,T=t.pick,i=C.win,n=i.document,r=C.seriesTypes,s=C.downloadURL,d=C.fireEvent;C.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}}),C.addEvent(C.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),C.Chart.prototype.setUpKeyToAxis=function(){r.arearange&&(r.arearange.prototype.keyToAxis={low:"y",high:"y"}),r.gantt&&(r.gantt.prototype.keyToAxis={start:"x",end:"x"})},C.Chart.prototype.getDataRows=function(h){function t(t,e,o){if(x.columnHeaderFormatter){var a=x.columnHeaderFormatter(t,e,o);if(!1!==a)return a}return t?t instanceof C.Axis?t.options.title&&t.options.title.text||(t.isDatetimeAxis?"DateTime":"Category"):h?{columnTitle:1<o?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<o?" ("+e+")":""):"Category"}function u(o,t,a){var n={},r={};return t.forEach(function(t){var e=(o.keyToAxis&&o.keyToAxis[t]||t)+"Axis",e=C.isNumber(a)?o.chart[e][a]:o[e];n[t]=e&&e.categories||[],r[t]=e&&e.isDatetimeAxis}),{categoryMap:n,dateTimeValueAxisMap:r}}var e,f=this.hasParallelCoordinates,m=this.time,x=this.options.exporting&&this.options.exporting.csv||{},o=this.xAxis,g={},a=[],y=[],b=[],v=[],w=0;for(n in this.setUpKeyToAxis(),this.series.forEach(function(n){var r,i=n.options.keys||n.pointArrayMap||["y"],s=i.length,l=!n.requireSorting&&{},c=o.indexOf(n.xAxis),p=u(n,i);if(!1!==n.options.includeInDataExport&&!n.options.isInternal&&!1!==n.visible){for(C.find(v,function(t){return t[0]===c})||v.push([c,w]),r=0;r<s;)e=t(n,i[r],i.length),b.push(e.columnTitle||e),h&&y.push(e.topLevelColumnTitle||e),r++;var d={chart:n.chart,autoIncrement:n.autoIncrement,options:n.options,pointArrayMap:n.pointArrayMap};n.options.data.forEach(function(t,e){f&&(p=u(n,i,e));var o={series:d};n.pointClass.prototype.applyOptions.apply(o,[t]),t=o.x;var a=n.data[e]&&n.data[e].name;for(r=0,n.xAxis&&"name"!==n.exportKey||(t=a),l&&(l[t]&&(t+="|"+e),l[t]=!0),g[t]||(g[t]=[],g[t].xValues=[]),g[t].x=o.x,g[t].name=a,g[t].xValues[c]=o.x;r<s;)a=o[e=i[r]],g[t][w+r]=T(p.categoryMap[e][a],p.dateTimeValueAxisMap[e]?m.dateFormat(x.dateFormat,a):null,a),r++}),w+=r}}),g)Object.hasOwnProperty.call(g,n)&&a.push(g[n]);for(var n=h?[y,b]:[b],w=v.length;w--;){var r=v[w][0],i=v[w][1],s=o[r];a.sort(function(t,e){return t.xValues[r]-e.xValues[r]});var l=t(s);n[0].splice(i,0,l),h&&n[1]&&n[1].splice(i,0,l),a.forEach(function(t){var e=t.name;s&&!c(e)&&(e=s.isDatetimeAxis?(t.x instanceof Date&&(t.x=t.x.getTime()),m.dateFormat(x.dateFormat,t.x)):s.categories?T(s.names[t.x],s.categories[t.x],t.x):t.x),t.splice(i,0,e)})}return n=n.concat(a),d(this,"exportData",{dataRows:n}),n},C.Chart.prototype.getCSV=function(t){var n="",r=this.getDataRows(),e=this.options.exporting.csv,i=T(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=T(e.itemDelimiter,","===i?";":","),l=e.lineDelimiter;return r.forEach(function(t,e){for(var o,a=t.length;a--;)"string"==typeof(o=t[a])&&(o='"'+o+'"'),"number"==typeof o&&"."!==i&&(o=o.toString().replace(".",i)),t[a]=o;n+=t.join(s),e<r.length-1&&(n+=l)}),n},C.Chart.prototype.getTable=function(t){var o='<table id="highcharts-data-table-'+this.index+'">',l=this.options,r=t?1.1.toLocaleString()[1]:".",c=T(l.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(c);function p(t,e,o,a){var n=T(a,"");return e="text"+(e?" "+e:""),"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),e="number"):a||(e="empty"),"<"+t+(o?" "+o:"")+' class="'+e+'">'+n+"</"+t+">"}var a=0,e=c?t.shift():null,n=t.shift();!1!==l.exporting.tableCaption&&(o+='<caption class="highcharts-table-caption">'+T(l.exporting.tableCaption,l.title.text?l.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var i=0,s=t.length;i<s;++i)t[i].length>a&&(a=t[i].length);return o+=function(t,e,o){var a="<thead>",n=0;o=o||e&&e.length;var r,i=0;if(r=c&&t&&e){t:if(r=t.length,e.length===r){for(;r--;)if(t[r]!==e[r]){r=!1;break t}r=!0}else r=!1;r=!r}if(r){for(a+="<tr>";n<o;++n){r=t[n];var s=t[n+1];r===s?++i:i?(a+=p("th","highcharts-table-topheading",'scope="col" colspan="'+(i+1)+'"',r),i=0):(r===e[n]?l.exporting.useRowspanHeaders?(s=2,delete e[n]):(s=1,e[n]=""):s=1,a+=p("th","highcharts-table-topheading",'scope="col"'+(1<s?' valign="top" rowspan="'+s+'"':""),r))}a+="</tr>"}if(e){for(a+="<tr>",n=0,o=e.length;n<o;++n)void 0!==e[n]&&(a+=p("th",null,'scope="col"',e[n]));a+="</tr>"}return a+"</thead>"}(e,n,Math.max(a,n.length)),o+="<tbody>",t.forEach(function(t){o+="<tr>";for(var e=0;e<a;e++)o+=p(e?"td":"th",null,e?"":'scope="row"',t[e]);o+="</tr>"}),d(this,"afterGetTable",t={html:o+="</tbody></table>"}),t.html},C.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);s(e(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},C.Chart.prototype.downloadXLS=function(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";s(e(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+i.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")},C.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=n.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),d(this,"afterViewData",this.dataTableDiv)},C.Chart.prototype.openInCloud=function(){var t=C.merge(this.userOptions);!function e(o){Object.keys(o).forEach(function(t){"function"==typeof o[t]&&delete o[t],a(o[t])&&e(o[t])})}(t),t={name:t.title&&t.title.text||"Chart title",options:t,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}};var o=JSON.stringify(t);!function(){var t=n.createElement("form");n.body.appendChild(t),t.method="post",t.action="https://cloud-api.highcharts.com/openincloud",t.target="_blank";var e=n.createElement("input");e.type="hidden",e.name="chart",e.value=o,t.appendChild(e),t.submit(),n.body.removeChild(t)}()},(t=C.getOptions().exporting)&&(o(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}}),t.buttons&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud")),r.map&&(r.map.prototype.exportKey="name"),r.mapbubble&&(r.mapbubble.prototype.exportKey="name"),r.treemap&&(r.treemap.prototype.exportKey="name")}),e(t,"masters/modules/export-data.src.js",[],function(){})});