!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/series-label",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,o))}e(t=t?t._modules:{},"modules/series-label.src.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(Y,t){function s(t,e,o,r,i,a){return 0<(t=(a-e)*(o-t)-(r-e)*(i-t))||!(t<0)}function l(t,e,o,r,i,a,h,n){return s(t,e,i,a,h,n)!==s(o,r,i,a,h,n)&&s(t,e,o,r,i,a)!==s(t,e,o,r,h,n)}function g(t,e,o,r,i,a,h,n){return l(t,e,t+o,e,i,a,h,n)||l(t+o,e,t+o,e+r,i,a,h,n)||l(t,e+r,t+o,e+r,i,a,h,n)||l(t,e,t,e+r,i,a,h,n)}function e(i){var a=this,h=Y.animObject(a.renderer.globalAnimation).duration;a.labelSeries=[],a.labelSeriesMaxSum=0,Y.clearTimeout(a.seriesLabelTimer),a.series.forEach(function(t){var e=t.options.label,o=t.labelBySeries,r=o&&o.closest;e.enabled&&t.visible&&(t.graph||t.area)&&!t.isSeriesBoosting&&(a.labelSeries.push(t),e.minFontSize&&e.maxFontSize&&(t.sum=t.yData.reduce(function(t,e){return(t||0)+(e||0)},0),a.labelSeriesMaxSum=Math.max(a.labelSeriesMaxSum,t.sum)),"load"===i.type&&(h=Math.max(h,Y.animObject(t.options.animation).duration)),r&&(void 0!==r[0].plotX?o.animate({x:r[0].plotX+r[1],y:r[0].plotY+r[2]}):o.attr({opacity:0})))}),a.seriesLabelTimer=o(function(){a.series&&a.labelSeries&&a.drawSeriesLabels()},a.renderer.forExport||!h?0:h)}var X=t.extend,x=t.isNumber,w=t.pick,o=t.syncTimeout;t=Y.addEvent;var r=Y.Series,i=Y.SVGRenderer,a=Y.Chart;Y.setOptions({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}}),i.prototype.symbols.connector=function(t,e,o,r,i){var a=i&&i.anchorX;i=i&&i.anchorY;var h,n,s=o/2;return x(a)&&x(i)&&(h=["M",a,i],(n=e-i)<0&&(n=-r-n),n<o&&(s=a<t+o/2?n:o-n),e+r<i?h.push("L",t+s,e+r):i<e?h.push("L",t+s,e):a<t?h.push("L",t,e+r/2):t+o<a&&h.push("L",t+o,e+r/2)),h||[]},r.prototype.getPointsOnGraph=function(){function t(t){var e=Math.round(t.plotX/8)+","+Math.round(t.plotY/8);p[e]||(p[e]=1,r.push(t))}if(this.xAxis||this.yAxis){var e,o=this.points,r=[],i=this.graph||this.area,a=i.element,h=this.chart.inverted,n=this.xAxis,s=this.yAxis,l=h?s.pos:n.pos,h=h?n.pos:s.pos,n=w(this.options.label.onArea,!!this.area),c=s.getThreshold(this.options.threshold),p={};if(this.getPointSpline&&a.getPointAtLength&&!n&&o.length<this.chart.plotSizeX/16){i.toD&&(e=i.attr("d"),i.attr({d:i.toD}));for(var d=a.getTotalLength(),u=0;u<d;u+=16)t({chartX:l+(s=a.getPointAtLength(u)).x,chartY:h+s.y,plotX:s.x,plotY:s.y});e&&i.attr({d:e}),(s=o[o.length-1]).chartX=l+s.plotX,s.chartY=h+s.plotY,t(s)}else for(d=o.length,u=0;u<d;u+=1){if(s=o[u],e=o[u-1],s.chartX=l+s.plotX,s.chartY=h+s.plotY,n&&(s.chartCenterY=h+(s.plotY+w(s.yBottom,c))/2),0<u&&(i=Math.abs(s.chartX-e.chartX),a=Math.abs(s.chartY-e.chartY),16<(i=Math.max(i,a))))for(i=Math.ceil(i/16),a=1;a<i;a+=1)t({chartX:e.chartX+a/i*(s.chartX-e.chartX),chartY:e.chartY+a/i*(s.chartY-e.chartY),chartCenterY:e.chartCenterY+a/i*(s.chartCenterY-e.chartCenterY),plotX:e.plotX+a/i*(s.plotX-e.plotX),plotY:e.plotY+a/i*(s.plotY-e.plotY)});x(s.plotY)&&t(s)}return r}},r.prototype.labelFontSize=function(t,e){return t+this.sum/this.chart.labelSeriesMaxSum*(e-t)+"px"},r.prototype.checkClearPoint=function(t,e,o,r){for(var i,a,h,n=Number.MAX_VALUE,s=Number.MAX_VALUE,l=w(this.options.label.onArea,!!this.area),c=l||this.options.label.connectorAllowed,p=this.chart,d=0;d<p.boxesToAvoid.length;d+=1){var u=p.boxesToAvoid[d],x=t+o.width,b=e,f=e+o.height;if(!(t>u.right||x<u.left||b>u.bottom||f<u.top))return!1}for(d=0;d<p.series.length;d+=1)if(u=(b=p.series[d]).interpolatedPoints,b.visible&&u){for(x=1;x<u.length;x+=1){if(u[x].chartX>=t-16&&u[x-1].chartX<=t+o.width+16){if(g(t,e,o.width,o.height,u[x-1].chartX,u[x-1].chartY,u[x].chartX,u[x].chartY))return!1;this===b&&!h&&r&&(h=g(t-16,e-16,o.width+32,o.height+32,u[x-1].chartX,u[x-1].chartY,u[x].chartX,u[x].chartY))}!c&&!h||this===b&&!l||(f=t+o.width/2-u[x].chartX,i=e+o.height/2-u[x].chartY,n=Math.min(n,f*f+i*i))}if(!l&&c&&this===b&&(r&&!h||n<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(x=1;x<u.length;x+=1){(h=Math.min(Math.pow(t+o.width/2-u[x].chartX,2)+Math.pow(e+o.height/2-u[x].chartY,2),Math.pow(t-u[x].chartX,2)+Math.pow(e-u[x].chartY,2),Math.pow(t+o.width-u[x].chartX,2)+Math.pow(e-u[x].chartY,2),Math.pow(t+o.width-u[x].chartX,2)+Math.pow(e+o.height-u[x].chartY,2),Math.pow(t-u[x].chartX,2)+Math.pow(e+o.height-u[x].chartY,2)))<s&&(s=h,a=u[x])}h=!0}}return!(r&&!h)&&{x:t,y:e,weight:n-(a?s:0),connectorPoint:a}},a.prototype.drawSeriesLabels=function(){var y=this,t=this.labelSeries;y.boxesToAvoid=[],t.forEach(function(t){t.interpolatedPoints=t.getPointsOnGraph(),(t.options.label.boxesToAvoid||[]).forEach(function(t){y.boxesToAvoid.push(t)})}),y.series.forEach(function(t){function e(t,e,o){var r=Math.max(s,w(a,-1/0)),i=Math.min(s+c,w(h,1/0));return r<t&&t<=i-o.width&&l<=e&&e<=l+p-o.height}if(t.xAxis||t.yAxis){var o,r,a,h,i=[],n=t.options.label,s=(r=y.inverted)?t.yAxis.pos:t.xAxis.pos,l=r?t.xAxis.pos:t.yAxis.pos,c=y.inverted?t.yAxis.len:t.xAxis.len,p=y.inverted?t.xAxis.len:t.yAxis.len,d=t.interpolatedPoints,u=w(n.onArea,!!t.area),x=t.labelBySeries,b=!x,f=n.minFontSize,g=n.maxFontSize,m="highcharts-color-"+w(t.colorIndex,"none");if(u&&!r&&(r=[t.xAxis.toPixels(t.xData[0]),t.xAxis.toPixels(t.xData[t.xData.length-1])],a=Math.min.apply(Math,r),h=Math.max.apply(Math,r)),t.visible&&!t.isSeriesBoosting&&d){for(x||(t.labelBySeries=x=y.renderer.label(t.name,0,-9999,"connector").addClass("highcharts-series-label highcharts-series-label-"+t.index+" "+(t.options.className||"")+m),y.renderer.styledMode||x.css(X({color:u?y.renderer.getContrast(t.color):t.color},t.options.label.style)),f&&g&&x.css({fontSize:t.labelFontSize(f,g)}),x.attr({padding:0,opacity:y.renderer.forExport?1:0,stroke:t.color,"stroke-width":1,zIndex:3}).add()),(f=x.getBBox()).width=Math.round(f.width),r=d.length-1;0<r;--r)u?e(g=d[r].chartX-f.width/2,m=d[r].chartCenterY-f.height/2,f)&&(o=t.checkClearPoint(g,m,f)):(e(g=d[r].chartX+3,m=d[r].chartY-f.height-3,f)&&(o=t.checkClearPoint(g,m,f,!0)),o&&i.push(o),e(g=d[r].chartX+3,m=d[r].chartY+3,f)&&(o=t.checkClearPoint(g,m,f,!0)),o&&i.push(o),e(g=d[r].chartX-f.width-3,m=d[r].chartY+3,f)&&(o=t.checkClearPoint(g,m,f,!0)),o&&i.push(o),e(g=d[r].chartX-f.width-3,m=d[r].chartY-f.height-3,f)&&(o=t.checkClearPoint(g,m,f,!0))),o&&i.push(o);if(n.connectorAllowed&&!i.length&&!u)for(g=s+c-f.width;s<=g;g-=16)for(m=l;m<l+p-f.height;m+=16)(o=t.checkClearPoint(g,m,f,!0))&&i.push(o);i.length?(i.sort(function(t,e){return e.weight-t.weight}),o=i[0],y.boxesToAvoid.push({left:o.x,right:o.x+f.width,top:o.y,bottom:o.y+f.height}),(i=Math.sqrt(Math.pow(Math.abs(o.x-x.x),2),Math.pow(Math.abs(o.y-x.y),2)))&&(n={opacity:y.renderer.forExport?1:0,x:o.x,y:o.y},d={opacity:1},i<=10&&(d={x:n.x,y:n.y},n={}),t.labelBySeries.attr(X(n,{anchorX:o.connectorPoint&&o.connectorPoint.plotX+s,anchorY:o.connectorPoint&&o.connectorPoint.plotY+l})).animate(d,b?.2*Y.animObject(t.options.animation).duration:y.renderer.globalAnimation),t.options.kdNow=!0,t.buildKDTree(),t=t.searchPoint({chartX:o.x,chartY:o.y},!0),x.closest=[t,o.x-t.plotX,o.y-t.plotY])):x&&(t.labelBySeries=x.destroy())}else x&&(t.labelBySeries=x.destroy())}}),Y.fireEvent(y,"afterDrawSeriesLabels")},t(a,"load",e),t(a,"redraw",e)}),e(t,"masters/modules/series-label.src.js",[],function(){})});