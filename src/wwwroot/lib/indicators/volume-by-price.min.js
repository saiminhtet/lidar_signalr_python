!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){function t(e,t,s,i){e.hasOwnProperty(t)||(e[t]=i.apply(null,s))}t(e=e?e._modules:{},"indicators/volume-by-price.src.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(p,e){var y=e.arrayMax,d=e.arrayMin,i=e.extend,u=e.isArray,D=Math.abs;e=p.noop;var o=p.addEvent,x=p.correctFloat,t=p.seriesType,b=p.seriesTypes.column.prototype;t("vbp","sma",{params:{ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"7px"},verticalAlign:"top"}},{nameBase:"Volume by Price",bindTo:{series:!1,eventName:"afterSetExtremes"},calculateOn:"render",markerAttribs:e,drawGraph:e,getColumnMetrics:b.getColumnMetrics,crispCol:b.crispCol,init:function(e){p.seriesTypes.sma.prototype.init.apply(this,arguments);var t=this.options.params,s=this.linkedParent,t=e.get(t.volumeSeriesID);return this.addCustomEvents(s,t),this},addCustomEvents:function(e,t){function s(){i.chart.redraw(),i.setData([]),i.zoneStarts=[],i.zoneLinesSVG&&(i.zoneLinesSVG.destroy(),delete i.zoneLinesSVG)}var i=this;return i.dataEventsToUnbind.push(o(e,"remove",function(){s()})),t&&i.dataEventsToUnbind.push(o(t,"remove",function(){s()})),i},animate:function(e){var s=this,t={};p.svg&&!e&&(t.translateX=s.yAxis.pos,s.group.animate(t,i(p.animObject(s.options.animation),{step:function(e,t){s.group.attr({scaleX:Math.max(.001,t.pos)})}})),s.animate=null)},drawPoints:function(){this.options.volumeDivision.enabled&&(this.posNegVolume(!0,!0),b.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1)),b.drawPoints.apply(this,arguments)},posNegVolume:function(e,t){var s,i=t?["positive","negative"]:["negative","positive"],o=this.options.volumeDivision,a=this.points.length,n=[],r=[],l=0;for(e?(this.posWidths=n,this.negWidths=r):(n=this.posWidths,r=this.negWidths);l<a;l++){var h,p,u=this.points[l];u[i[0]+"Graphic"]=u.graphic,u.graphic=u[i[1]+"Graphic"],e&&(h=u.shapeArgs.width,(s=(p=this.priceZones[l]).wholeVolumeData)?(n.push(h/s*p.positiveVolumeData),r.push(h/s*p.negativeVolumeData)):(n.push(0),r.push(0))),u.color=t?o.styles.positiveColor:o.styles.negativeColor,u.shapeArgs.width=t?this.posWidths[l]:this.negWidths[l],u.shapeArgs.x=t?u.shapeArgs.x:this.posWidths[l]}},translate:function(){var s,i,o,a=this,e=a.options,t=a.chart,n=a.yAxis,r=n.min,l=a.options.zoneLines,h=a.priceZones,p=0;b.translate.apply(a);var u,d,c,m,v,g,f=a.points;f.length&&(u=e.pointPadding<.5?e.pointPadding:.1,e=a.volumeDataArray,d=y(e),c=t.plotWidth/2,m=t.plotTop,v=D(n.toPixels(r)-n.toPixels(r+a.rangeStep)),g=D(n.toPixels(r)-n.toPixels(r+a.rangeStep)),u&&(r=D(v*(1-2*u)),p=D((v-r)/2),v=D(r)),f.forEach(function(e,t){i=e.barX=e.plotX=0,o=e.plotY=n.toPixels(h[t].start)-m-(n.reversed?v-g:v)-p,s=x(c*h[t].wholeVolumeData/d),e.pointWidth=s,e.shapeArgs=a.crispCol.apply(a,[i,o,s,v]),e.volumeNeg=h[t].negativeVolumeData,e.volumePos=h[t].positiveVolumeData,e.volumeAll=h[t].wholeVolumeData}),l.enabled&&a.drawZones(t,n,a.zoneStarts,l.styles))},getValues:function(e,t){var s,i=e.processedXData,o=e.processedYData,a=this.chart,n=t.ranges,r=[],l=[],h=[];return e.chart?(s=a.get(t.volumeSeriesID))?(t=u(o[0]))&&4!==o[0].length?p.error("Type of "+e.name+" series is different than line, OHLC or candlestick.",!0,a):((this.priceZones=this.specifyZones(t,i,o,n,s)).forEach(function(e,t){r.push([e.x,e.end]),l.push(r[t][0]),h.push(r[t][1])}),{values:r,xData:l,yData:h}):p.error("Series "+t.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,a):p.error("Base series not found! In case it has been removed, add a new one.",!0,a)},specifyZones:function(e,t,s,i,o){if(e){for(var a,n=s.length,r=s[0][3],l=r,h=1;h<n;h++)(a=s[h][3])<r&&(r=a),l<a&&(l=a);n={min:r,max:l}}else n=!1;n=(r=n)?r.min:d(s),a=r?r.max:y(s),r=this.zoneStarts=[],l=[];var p=0,h=1;if(!n||!a)return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG.destroy()),[];var u=this.rangeStep=x(a-n)/i;for(r.push(n);p<i-1;p++)r.push(x(r[p]+u));for(r.push(a),i=r.length;h<i;h++)l.push({index:h-1,x:t[0],start:r[h-1],end:r[h]});return this.volumePerZone(e,l,o,t,s)},volumePerZone:function(t,e,s,i,o){var a,n,r,l,h,p=this,u=s.processedXData,d=s.processedYData,c=e.length-1,m=o.length;return s=d.length,D(m-s)&&(i[0]!==u[0]&&d.unshift(0),i[m-1]!==u[s-1]&&d.push(0)),p.volumeDataArray=[],e.forEach(function(e){for(e.wholeVolumeData=0,e.positiveVolumeData=0,h=e.negativeVolumeData=0;h<m;h++)r=n=!1,l=t?o[h][3]:o[h],a=h?t?o[h-1][3]:o[h-1]:l,l<=e.start&&0===e.index&&(n=!0),l>=e.end&&e.index===c&&(r=!0),(l>e.start||n)&&(l<e.end||r)&&(e.wholeVolumeData+=d[h],l<a?e.negativeVolumeData+=d[h]:e.positiveVolumeData+=d[h]);p.volumeDataArray.push(e.wholeVolumeData)}),e},drawZones:function(t,s,e,i){var o,a=t.renderer,n=this.zoneLinesSVG,r=[],l=t.plotWidth,h=t.plotTop;e.forEach(function(e){o=s.toPixels(e)-h,r=r.concat(t.renderer.crispLine(["M",0,o,"L",l,o],i.lineWidth))}),n?n.animate({d:r}):n=this.zoneLinesSVG=a.path(r).attr({"stroke-width":i.lineWidth,stroke:i.color,dashstyle:i.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)}},{destroy:function(){return this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),p.Point.prototype.destroy.apply(this,arguments)}})}),t(e,"masters/indicators/volume-by-price.src.js",[],function(){})});